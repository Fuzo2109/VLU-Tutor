<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLU Tutor System - Learner Dashboard</title>
    <link rel="stylesheet" href="css/layout-base.css">
    <link rel="stylesheet" href="css/learner-theme.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <!-- Logo -->
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="logo-text">VLU Learner</div>
            </div>

            <!-- User Profile -->
            <div class="user-profile">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-name">Nguyen Van A</div>
                <div class="user-role">Student</div>
                <div style="font-size: var(--font-size-xs); color: var(--gray-500); margin-top: var(--spacing-xs);">
                    ID: 12345678
                </div>
            </div>

            <!-- Navigation Menu -->
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active">
                            <i class="nav-icon fas fa-tachometer-alt"></i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showApplyTutorModal()">
                            <i class="nav-icon fas fa-user-plus"></i>
                            Apply as Tutor
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showFindTutorModal()">
                            <i class="nav-icon fas fa-search"></i>
                            Find Tutor
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showMyScheduleModal()">
                            <i class="nav-icon fas fa-calendar-alt"></i>
                            My Schedule
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showProfileModal()">
                            <i class="nav-icon fas fa-user-circle"></i>
                            Profile
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="index.html" class="nav-link">
                            <i class="nav-icon fas fa-sign-out-alt"></i>
                            Logout
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1 style="font-size: var(--font-size-2xl); color: var(--gray-800); margin: 0;">
                        Welcome to VLU Tutor System
                    </h1>
                </div>
                <div class="header-right">
                    <div class="notification-bell">
                        <i class="fas fa-bell" style="font-size: 20px; color: var(--gray-600);"></i>
                        <div class="notification-badge">3</div>
                    </div>
                    <div class="user-avatar" style="width: 40px; height: 40px; margin: 0;">
                        <i class="fas fa-user" style="font-size: 16px;"></i>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Key Metrics Cards -->
                <div class="metrics-grid">
                    <div class="card fade-in">
                        <div class="card-header">
                            <div class="card-title">Upcoming Lessons</div>
                            <div class="card-icon" style="background: var(--learner-primary);">
                                <i class="fas fa-clock"></i>
                            </div>
                        </div>
                        <div class="card-value">5</div>
                        <div class="card-label">This Week</div>
                    </div>

                    <div class="card fade-in">
                        <div class="card-header">
                            <div class="card-title">Completed Lessons</div>
                            <div class="card-icon" style="background: var(--learner-secondary);">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="card-value">24</div>
                        <div class="card-label">Total</div>
                    </div>

                    <div class="card fade-in">
                        <div class="card-header">
                            <div class="card-title">Study Hours</div>
                            <div class="card-icon" style="background: #4caf50;">
                                <i class="fas fa-hourglass-half"></i>
                            </div>
                        </div>
                        <div class="card-value">48</div>
                        <div class="card-label">Hours</div>
                    </div>

                    <div class="card fade-in">
                        <div class="card-header">
                            <div class="card-title">GPA</div>
                            <div class="card-icon" style="background: #ff9800;">
                                <i class="fas fa-star"></i>
                            </div>
                        </div>
                        <div class="card-value">3.8</div>
                        <div class="card-label">Current</div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section">
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-title">Study Time Statistics</div>
                        </div>
                        <canvas id="studyTimeChart" width="400" height="200"></canvas>
                    </div>

                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-title">Subject Progress</div>
                        </div>
                        <canvas id="subjectProgressChart" width="200" height="200"></canvas>
                    </div>
                </div>

                <!-- Tables Section -->
                <div class="tables-section">
                    <div class="table-container">
                        <div class="table-header">
                            <div class="table-title">Upcoming Lessons</div>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Subject</th>
                                    <th>Tutor</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Mathematics</td>
                                    <td>Dr. Smith</td>
                                    <td>Today, 14:00</td>
                                    <td><span style="color: #4caf50;">Active</span></td>
                                </tr>
                                <tr>
                                    <td>Physics</td>
                                    <td>Ms. Johnson</td>
                                    <td>Tomorrow, 10:00</td>
                                    <td><span style="color: #ff9800;">Scheduled</span></td>
                                </tr>
                                <tr>
                                    <td>Chemistry</td>
                                    <td>Prof. Brown</td>
                                    <td>Friday, 16:00</td>
                                    <td><span style="color: #ff9800;">Scheduled</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="table-container">
                        <div class="table-header">
                            <div class="table-title">Recent Lessons</div>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Subject</th>
                                    <th>Tutor</th>
                                    <th>Date</th>
                                    <th>Rating</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>English</td>
                                    <td>Ms. Davis</td>
                                    <td>Yesterday</td>
                                    <td><span style="color: #ffc107;">★★★★☆</span></td>
                                </tr>
                                <tr>
                                    <td>Computer Science</td>
                                    <td>Dr. Wilson</td>
                                    <td>2 days ago</td>
                                    <td><span style="color: #ffc107;">★★★★★</span></td>
                                </tr>
                                <tr>
                                    <td>Biology</td>
                                    <td>Prof. Miller</td>
                                    <td>3 days ago</td>
                                    <td><span style="color: #ffc107;">★★★☆☆</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Apply as Tutor Modal -->
    <div id="applyTutorModal" style="display:none; position:fixed; z-index:10001; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.25); align-items:center; justify-content:center;">
        <div class="tutor-modal-frame" style="width:60vw; max-height:90vh; overflow:hidden; display:flex; flex-direction:column;">
            <!-- Header Section -->
            <div style="background: linear-gradient(135deg, var(--learner-primary) 0%, var(--learner-secondary) 100%); padding: 32px; color: white; position: relative;">
                <button onclick="closeApplyTutorModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 18px;">×</button>
                
                <div style="display: flex; align-items: center; gap: 24px;">
                    <!-- Profile Image Area -->
                    <div style="width: 120px; height: 120px; border-radius: 50%; border: 4px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="document.getElementById('profileImage').click();">
                        <i class="fas fa-camera" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                    <input type="file" id="profileImage" accept="image/*" style="display:none;" onchange="previewProfileImage(this)">
                    
                    <!-- User Info -->
                    <div style="flex: 1;">
                        <h2 style="font-size: 2.5rem; font-weight: 700; margin: 0 0 8px 0;">Apply as Tutor</h2>
                        <p style="font-size: 1.3rem; margin: 0 0 12px 0; opacity: 0.9;">Complete your tutor application</p>
                        <div style="display: flex; align-items: center; gap: 16px;">
                            <span style="font-size: 1.1rem; opacity: 0.8;"><i class="fas fa-user-graduate"></i> Student</span>
                            <span style="font-size: 1.1rem; opacity: 0.8;"><i class="fas fa-id-card"></i> ID: 12345678</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div style="display: flex; flex: 1; min-height: 0;">
                <!-- Left Column - Application Form -->
                <div style="flex: 1; padding: 32px; background: var(--learner-background); overflow-y: auto; max-height: calc(90vh - 200px);">
                    <h3 style="color: var(--learner-primary); margin-bottom: 24px; font-size: 2rem; font-weight: 600; border-bottom: 2px solid var(--learner-accent); padding-bottom: 12px;">Application Form</h3>
                    
                    <form id="tutorApplyForm">
                        <!-- Learner Information Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.8rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-user"></i> Learner Information
                            </h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; font-size: 1.1rem;">
                                <div><strong>Name:</strong> <span>Nguyen Van A</span></div>
                                <div><strong>Student ID:</strong> <span>12345678</span></div>
                                <div><strong>Email:</strong> <span>student@vlu.edu.vn</span></div>
                                <div><strong>Class:</strong> <span>CTK43</span></div>
                                <div><strong>Date of Birth:</strong> <span>01/01/2003</span></div>
                                <div><strong>Phone:</strong> <span>0123456789</span></div>
                            </div>
                        </div>
                        
                        <!-- GPA Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-graduation-cap"></i> Academic Information
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label for="gpa" style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 8px;">GPA: <span style="color:#ff0000;">*</span></label>
                                <input type="number" step="0.01" min="0" max="4" id="gpa" name="gpa" required style="width:100%;padding:12px 16px;border:1px solid #e0e0e0;border-radius:8px;font-size:1.1rem;background:#fafafa;" placeholder="Enter your GPA (e.g., 3.5)">
                                <div id="gpa-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please enter a valid GPA between 0 and 4</div>
                            </div>
                        </div>
                        
                        <!-- Teaching Subjects Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-list"></i> Teaching Subjects
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label for="subjects" style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 8px;">Subjects you can teach: <span style="color:#ff0000;">*</span></label>
                                <select id="subjects" name="subjects" multiple required style="width:100%;padding:12px 16px;min-height:80px;font-size:1.1rem;border:1px solid #e0e0e0;border-radius:8px;background:#fafafa;">
                                    <option value="mathematics">Mathematics</option>
                                    <option value="physics">Physics</option>
                                    <option value="chemistry">Chemistry</option>
                                    <option value="english">English</option>
                                    <option value="cs">Computer Science</option>
                                    <option value="biology">Biology</option>
                                    <option value="economics">Economics</option>
                                    <option value="other">Other</option>
                                </select>
                                <div id="subjects-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please select at least one subject</div>
                            </div>
                        </div>
                        
                        <!-- Teaching Experience Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-laptop"></i> Teaching Experience
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label for="experience" style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 8px;">Teaching Experience: <span style="color:#ff0000;">*</span></label>
                                <textarea id="experience" name="experience" rows="4" style="width:100%;padding:12px 16px;resize:vertical;border:1px solid #e0e0e0;border-radius:8px;font-size:1.1rem;background:#fafafa;" required placeholder="Describe your previous teaching experience..."></textarea>
                                <div id="experience-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please describe your teaching experience</div>
                            </div>
                        </div>
                        
                        <!-- Teaching Schedule Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-clock"></i> Preferred Teaching Schedule
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 12px;">Select your preferred time slots: <span style="color:#ff0000;">*</span></label>
                                <div style="display: grid; gap: 12px;">
                                    <label style="display: flex; align-items: center; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; background: #fafafa; cursor: pointer; transition: all 0.2s;">
                                        <input type="checkbox" id="morning" name="schedule" value="morning" required style="margin-right: 12px; transform: scale(1.2);"> 
                                        <span style="font-size: 1.1rem;">Morning (8:00 - 11:00)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; background: #fafafa; cursor: pointer; transition: all 0.2s;">
                                        <input type="checkbox" id="afternoon" name="schedule" value="afternoon" required style="margin-right: 12px; transform: scale(1.2);"> 
                                        <span style="font-size: 1.1rem;">Afternoon (13:00 - 17:00)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; background: #fafafa; cursor: pointer; transition: all 0.2s;">
                                        <input type="checkbox" id="evening" name="schedule" value="evening" required style="margin-right: 12px; transform: scale(1.2);"> 
                                        <span style="font-size: 1.1rem;">Evening (18:00 - 21:00)</span>
                                    </label>
                                </div>
                                <div id="schedule-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please select at least one time slot</div>
                            </div>
                        </div>
                        
                        <!-- Certificates Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-certificate"></i> Certificates & Documents
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 8px;">Upload your certificates: <span style="color:#ff0000;">*</span></label>
                                <div id="certificates-section">
                                    <!-- Upload fields will be added here by JS -->
                                </div>
                                <button type="button" id="addCertificateBtn" style="margin-top: 12px; background: var(--learner-primary); color: #fff; border: none; border-radius: 8px; padding: 12px 20px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s;">
                                    <i class="fas fa-plus"></i> Add Certificate
                                </button>
                                <div id="certificates-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please upload at least one certificate</div>
                            </div>
                        </div>
                        
                        <!-- Additional Information Section -->
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-info-circle"></i> Additional Information
                            </h4>
                            <div style="margin-bottom: 16px;">
                                <label for="description" style="font-weight: 500; font-size: 1.1rem; display: block; margin-bottom: 8px;">Additional Description: <span style="color:#ff0000;">*</span></label>
                                <textarea id="description" name="description" rows="4" style="width:100%;padding:12px 16px;resize:vertical;border:1px solid #e0e0e0;border-radius:8px;font-size:1.1rem;background:#fafafa;" required placeholder="Please provide additional information about your qualifications..."></textarea>
                                <div id="description-error" style="color:#ff0000;font-size:1rem;margin-top:6px;display:none;">Please provide additional description</div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div id="tutorApplyActions" style="display: flex; justify-content: flex-end; gap: 16px; padding: 24px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                            <button type="button" id="saveTutorApplyBtn" onclick="saveTutorApplication()" style="background: var(--learner-primary); color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s;">
                                <i class="fas fa-save"></i> Save
                            </button>
                            <button type="button" id="previewTutorApplyBtn" onclick="previewTutorApplication()" style="background: #b11f24; color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s;">
                                <i class="fas fa-eye"></i> Preview
                            </button>
                            <button type="button" id="editTutorApplyBtn" onclick="showEditMode()" style="background: #888; color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s; display: none;">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button type="submit" id="submitTutorApplyBtn" onclick="submitTutorApplication(event)" style="background: #43a047; color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s; display: none;">
                                <i class="fas fa-paper-plane"></i> Submit
                            </button>
                            <button type="button" onclick="closeApplyTutorModal()" style="background: #888; color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s;">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Right Column - Application Status -->
                <div style="flex: 1; padding: 32px; background: var(--gray-50); overflow-y: auto; max-height: calc(90vh - 200px);">
                    <h3 style="color: var(--learner-primary); margin-bottom: 24px; font-size: 1.4rem; font-weight: 600; border-bottom: 2px solid var(--learner-accent); padding-bottom: 12px;">Application Status</h3>
                    
                    <!-- Status Tabs -->
                    <div style="display: flex; gap: 12px; margin-bottom: 32px;">
                        <button id="pendingTab" class="status-tab active" style="flex: 1; padding: 16px 20px; border: none; border-radius: 12px; background: var(--learner-primary); color: #fff; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(25, 118, 210, 0.3);">
                            <i class="fas fa-clock"></i> Pending
                        </button>
                        <button id="needsInfoTab" class="status-tab" style="flex: 1; padding: 16px 20px; border: none; border-radius: 12px; background: #ffc107; color: #333; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                            <i class="fas fa-exclamation-triangle"></i> Needs Info
                        </button>
                        <button id="approvedTab" class="status-tab" style="flex: 1; padding: 16px 20px; border: none; border-radius: 12px; background: #4caf50; color: #fff; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                            <i class="fas fa-check-circle"></i> Approved
                        </button>
                    </div>
                    
                    <!-- Status Content -->
                    <div id="statusContent" style="min-height: 400px;">
                        <!-- Pending Status -->
                        <div id="pendingContent" class="status-content active" style="display: block;">
                            <div style="text-align: center; padding: 40px 20px; background: white; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.1);">
                                <i class="fas fa-clock" style="font-size: 4rem; color: var(--learner-primary); margin-bottom: 24px;"></i>
                                <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.6rem; font-weight: 600;">Your application is under review</h4>
                                <p style="color: #666; font-size: 1.1rem; line-height: 1.6; margin-bottom: 24px;">Your application is currently under review by VLU Center. You will be notified once a decision is made.</p>
                                <div style="background: var(--learner-accent); border-radius: 8px; padding: 16px; border-left: 4px solid var(--learner-primary);">
                                    <p style="color: var(--learner-primary); font-size: 1rem; margin: 0;"><strong>Estimated review time:</strong> 3–5 business days</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Needs Info Status -->
                        <div id="needsInfoContent" class="status-content" style="display: none;">
                            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.1); padding: 32px;">
                                <div style="text-align: center; margin-bottom: 32px;">
                                    <i class="fas fa-exclamation-triangle" style="font-size: 4rem; color: #ffc107; margin-bottom: 20px;"></i>
                                    <h4 style="color: #ffc107; margin-bottom: 16px; font-size: 1.6rem; font-weight: 600;">Additional Information Required</h4>
                                </div>
                                <div style="background: #fff8e1; border-radius: 12px; padding: 24px; border-left: 4px solid #ffc107;">
                                    <h5 style="color: #333; margin-bottom: 20px; font-size: 1.3rem; font-weight: 600;">Please provide the following additional information:</h5>
                                    <ul style="color: #333; font-size: 1.1rem; line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-phone" style="color: #ffc107;"></i>
                                            <strong>Phone number</strong>
                                        </li>
                                        <li style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-certificate" style="color: #ffc107;"></i>
                                            <strong>Additional certificates</strong>
                                        </li>
                                        <li style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-video" style="color: #ffc107;"></i>
                                            <strong>Demo video links</strong>
                                        </li>
                                        <li style="margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-edit" style="color: #ffc107;"></i>
                                            <strong>Enhanced description</strong>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Approved Status -->
                        <div id="approvedContent" class="status-content" style="display: none;">
                            <div style="background: white; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.1); padding: 32px;">
                                <div style="text-align: center; margin-bottom: 32px;">
                                    <i class="fas fa-check-circle" style="font-size: 4rem; color: #4caf50; margin-bottom: 20px;"></i>
                                    <h4 style="color: #4caf50; margin-bottom: 16px; font-size: 1.6rem; font-weight: 600;">Congratulations!</h4>
                                    <p style="color: #666; font-size: 1.1rem; line-height: 1.6; margin-bottom: 24px;">Your application has been approved. Here are your interview details:</p>
                                </div>
                                
                                <!-- Interview Details Display -->
                                <div id="interviewDetailsDisplay" style="background: #e8f5e8; border-radius: 12px; padding: 24px; border-left: 4px solid #4caf50; margin-bottom: 24px;">
                                    <h5 style="color: #333; margin-bottom: 20px; font-size: 1.3rem; font-weight: 600;">Interview Details:</h5>
                                    <div id="interviewInfo" style="display: grid; gap: 16px;">
                                        <!-- Interview info will be loaded here -->
                                    </div>
                                </div>
                                
                                <!-- Reschedule Request Form -->
                                <div id="rescheduleForm" style="background: #fff8e1; border-radius: 12px; padding: 24px; border-left: 4px solid #ffc107;">
                                    <h5 style="color: #333; margin-bottom: 20px; font-size: 1.3rem; font-weight: 600;">Need to Reschedule?</h5>
                                    <p style="color: #666; font-size: 1.1rem; margin-bottom: 20px;">If you need to reschedule your interview, please provide your preferred date and reason:</p>
                                    
                                    <div style="display: grid; gap: 16px;">
                                        <div>
                                            <label style="font-weight: 500; font-size: 1.1rem; color: #333; display: block; margin-bottom: 8px;">Preferred Date: <span style="color:#ff0000;">*</span></label>
                                            <input type="date" id="rescheduleDate" 
                                                   style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; background: #fafafa;">
                                        </div>
                                        <div>
                                            <label style="font-weight: 500; font-size: 1.1rem; color: #333; display: block; margin-bottom: 8px;">Preferred Time: <span style="color:#ff0000;">*</span></label>
                                            <select id="rescheduleTime" style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; background: #fafafa;">
                                                <option value="">Select time</option>
                                                <option value="09:00">Morning (9:00 AM - 11:00 AM)</option>
                                                <option value="14:00">Afternoon (2:00 PM - 4:00 PM)</option>
                                                <option value="18:00">Evening (6:00 PM - 8:00 PM)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-weight: 500; font-size: 1.1rem; color: #333; display: block; margin-bottom: 8px;">Reason for Reschedule: <span style="color:#ff0000;">*</span></label>
                                            <textarea id="applyRescheduleReason" rows="3" 
                                                      style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; background: #fafafa; resize: vertical;"
                                                      placeholder="Please explain why you need to reschedule..."></textarea>
                                        </div>
                                        <button type="button" onclick="submitRescheduleRequest()" 
                                                style="width: 100%; padding: 16px; background: #ffc107; color: #333; border: none; border-radius: 8px; font-size: 1.2rem; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                                            <i class="fas fa-calendar-plus"></i> Submit Reschedule Request
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Reschedule Request Status -->
                                <div id="rescheduleStatus" style="display: none; background: #e3f2fd; border-radius: 12px; padding: 24px; border-left: 4px solid #2196f3; margin-top: 24px;">
                                    <h5 style="color: #333; margin-bottom: 16px; font-size: 1.3rem; font-weight: 600;">Reschedule Request Status:</h5>
                                    <div id="rescheduleStatusContent">
                                        <!-- Reschedule status will be loaded here -->
                                    </div>
                                </div>
                                
                                <!-- Submit Button -->
                                <div style="margin-top: 24px; text-align: center;">
                                    <button onclick="submitRescheduleRequest()" 
                                            style="background: var(--learner-primary); color: white; border: none; border-radius: 8px; padding: 16px 32px; cursor: pointer; font-size: 1.2rem; font-weight: 600; box-shadow: 0 4px 12px rgba(25, 118, 210, 0.3); transition: all 0.3s;">
                                        <i class="fas fa-paper-plane"></i> Submit Reschedule Request
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- My Schedule Modal -->
    <div id="myScheduleModal" class="modal" style="display: none; position: fixed; z-index: 10004; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeMyScheduleModal()">
        <div class="modal-content" style="width: 95%; max-width: 1400px; max-height: 95vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Schedule Header -->
            <div class="schedule-header" style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeMyScheduleModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="display: flex; align-items: center; gap: 16px;">
                    <i class="fas fa-calendar-check" style="font-size: 1.5rem;"></i>
                    <div>
                        <h2 style="margin: 0; font-size: 1.6rem;">My Schedule</h2>
                        <div id="myScheduleWeekRange" style="font-size: 0.9rem; opacity: 0.9;">Week of January 15-21, 2024</div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 16px;">
                    <button onclick="mySchedulePreviousWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        <i class="fas fa-chevron-left"></i> Previous Week
                    </button>
                    <button onclick="myScheduleCurrentWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        Current Week
                    </button>
                    <button onclick="myScheduleNextWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        Next Week <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Schedule Content -->
            <div style="display: flex; height: calc(95vh - 140px);">
                <!-- Left Panel - Week Calendar -->
                <div style="width: 60%; padding: 24px; overflow-y: auto;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px;">Weekly View</h3>
                    <div id="myScheduleWeekCalendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 12px;">
                        <!-- Calendar days will be generated here -->
                    </div>
                </div>
                
                <!-- Right Panel - Upcoming Lessons -->
                <div style="width: 40%; background: #f8f9fa; padding: 24px; border-left: 1px solid #e0e0e0; overflow-y: auto;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px;">Upcoming Lessons</h3>
                    <div id="upcomingLessons" style="display: flex; flex-direction: column; gap: 16px;">
                        <!-- Lessons will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal" style="display: none; position: fixed; z-index: 10006; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeProfileModal()">
        <div class="modal-content" style="width: 90%; max-width: 800px; max-height: 90vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Profile Header -->
            <div class="profile-header" style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeProfileModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <h2 id="profileStudentName" style="margin: 0; font-size: 1.8rem;">Nguyen Van A</h2>
                        <div style="font-size: 1rem; opacity: 0.9;">Student ID: 12345678</div>
                        <div style="font-size: 0.9rem; opacity: 0.8;">Learner Account</div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Content -->
            <div style="padding: 24px; overflow-y: auto; max-height: calc(90vh - 140px);">
                <!-- Personal Information -->
                <div style="margin-bottom: 32px;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-user-circle"></i>
                        Personal Information
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Full Name</label>
                            <div id="profileFullName" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">Nguyen Van A</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Student ID</label>
                            <div id="profileStudentId" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">12345678</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Email</label>
                            <div id="profileEmail" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">nguyenvana@vlu.edu.vn</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Phone Number</label>
                            <div id="profilePhone" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">+84 123 456 789</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Date of Birth</label>
                            <div id="profileDob" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">15/03/2000</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Gender</label>
                            <div id="profileGender" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">Male</div>
                        </div>
                    </div>
                </div>
                
                <!-- Academic Information -->
                <div style="margin-bottom: 32px;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-graduation-cap"></i>
                        Academic Information
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Major</label>
                            <div id="profileMajor" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">Computer Science</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Year Level</label>
                            <div id="profileYearLevel" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">3rd Year</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Current GPA</label>
                            <div id="profileGpa" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">3.75</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Total Credits</label>
                            <div id="profileCredits" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">85</div>
                        </div>
                    </div>
                </div>
                
                <!-- Learning Statistics -->
                <div style="margin-bottom: 32px;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-chart-line"></i>
                        Learning Statistics
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                        <div style="text-align: center; padding: 20px; background: #e3f2fd; border-radius: 8px; border: 1px solid var(--learner-primary);">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--learner-primary);" id="profileTotalLessons">24</div>
                            <div style="font-size: 0.9rem; color: #666;">Total Lessons</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #e8f5e8; border-radius: 8px; border: 1px solid #4caf50;">
                            <div style="font-size: 2rem; font-weight: 700; color: #4caf50;" id="profileStudyHours">48</div>
                            <div style="font-size: 0.9rem; color: #666;">Study Hours</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #fff3e0; border-radius: 8px; border: 1px solid #ff9800;">
                            <div style="font-size: 2rem; font-weight: 700; color: #ff9800;" id="profileUpcomingLessons">5</div>
                            <div style="font-size: 0.9rem; color: #666;">Upcoming</div>
                        </div>
                    </div>
                </div>
                
                <!-- Account Information -->
                <div style="margin-bottom: 32px;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-shield-alt"></i>
                        Account Information
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Account Status</label>
                            <div style="padding: 12px; background: #e8f5e8; border: 1px solid #4caf50; border-radius: 6px; font-size: 1rem; color: #4caf50; font-weight: 600;">
                                <i class="fas fa-check-circle"></i> Active
                            </div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Member Since</label>
                            <div id="profileMemberSince" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">September 2023</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Last Login</label>
                            <div id="profileLastLogin" style="padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 1rem;">Today, 10:30 AM</div>
                        </div>
                        <div class="info-group">
                            <label style="font-weight: 600; color: #666; font-size: 0.9rem; margin-bottom: 4px; display: block;">Account Type</label>
                            <div style="padding: 12px; background: #e3f2fd; border: 1px solid var(--learner-primary); border-radius: 6px; font-size: 1rem; color: var(--learner-primary); font-weight: 600;">
                                <i class="fas fa-user-graduate"></i> Student
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; justify-content: center; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                    <button onclick="closeProfileModal()" style="background: #6c757d; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#5a6268'" onmouseout="this.style.background='#6c757d'">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Set user role automatically when page loads
            const currentRole = detectUserRole();
            console.log('Current user role detected:', currentRole);
            
            // Study Time Chart
            const studyTimeCtx = document.getElementById('studyTimeChart').getContext('2d');
            new Chart(studyTimeCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Study Hours',
                        data: [2, 3, 4, 2, 5, 3, 1],
                        borderColor: '#1976d2',
                        backgroundColor: 'rgba(25, 118, 210, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 6
                        }
                    }
                }
            });

            // Subject Progress Chart
            const subjectProgressCtx = document.getElementById('subjectProgressChart').getContext('2d');
            new Chart(subjectProgressCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Mathematics', 'Physics', 'Chemistry', 'English'],
                    datasets: [{
                        data: [85, 70, 90, 75],
                        backgroundColor: ['#1976d2', '#42a5f5', '#4caf50', '#ff9800']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        });

        // Modal Functions
        function showApplyTutorModal() {
            console.log('Opening Apply Tutor Modal...');
            document.getElementById('applyTutorModal').style.display = 'flex';
            console.log('Apply Tutor Modal opened successfully');
            
            // Reset form and remove any existing preview content
            resetTutorApplicationForm();
        }

        function closeApplyTutorModal() {
            console.log('Closing Apply Tutor Modal...');
            document.getElementById('applyTutorModal').style.display = 'none';
            
            // Reset form when closing
            resetTutorApplicationForm();
        }
        
        function resetTutorApplicationForm() {
            console.log('Resetting tutor application form...');
            
            // Remove existing preview content
            const existingPreview = document.getElementById('previewContent');
            if (existingPreview) {
                existingPreview.remove();
            }
            
            // Show all form inputs
            const formInputs = document.querySelectorAll('#tutorApplyForm input, #tutorApplyForm textarea, #tutorApplyForm select');
            formInputs.forEach(input => {
                input.style.display = '';
            });
            
            // Reset form fields
            document.getElementById('gpa').value = '';
            document.getElementById('subjects').selectedIndex = -1;
            document.getElementById('experience').value = '';
            document.getElementById('description').value = '';
            
            // Uncheck all schedule checkboxes
            document.querySelectorAll('input[name="schedule"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Clear file inputs
            document.querySelectorAll('#certificates-section input[type="file"]').forEach(input => {
                input.value = '';
            });
            
            // Hide all error messages
            const errorElements = document.querySelectorAll('[id$="-error"]');
            errorElements.forEach(error => {
                error.style.display = 'none';
            });
            
            // Show Save and Preview buttons, hide Edit and Submit
            document.getElementById('saveTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('previewTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('editTutorApplyBtn').style.display = 'none';
            document.getElementById('submitTutorApplyBtn').style.display = 'none';
        }





        function showProfileModal() {
            try {
                console.log('Opening Profile modal...');
                const modal = document.getElementById('profileModal');
                modal.style.display = 'flex';
                console.log('Profile Modal opened successfully');
                
                // Load learner profile data
                loadLearnerProfileData();
                
            } catch (error) {
                console.error('Error opening Profile modal:', error);
                alert('Error opening Profile modal: ' + error.message);
            }
        }
        
        function loadLearnerProfileData() {
            // Demo learner data - in real app this would come from localStorage or API
            const learnerData = {
                fullName: "Nguyen Van A",
                studentId: "12345678",
                email: "nguyenvana@vlu.edu.vn",
                phone: "+84 123 456 789",
                dateOfBirth: "15/03/2000",
                gender: "Male",
                major: "Computer Science",
                yearLevel: "3rd Year",
                gpa: "3.75",
                totalCredits: "85",
                totalLessons: "24",
                studyHours: "48",
                upcomingLessons: "5",
                memberSince: "September 2023",
                lastLogin: "Today, 10:30 AM"
            };
            
            // Update profile elements
            document.getElementById('profileStudentName').textContent = learnerData.fullName;
            document.getElementById('profileFullName').textContent = learnerData.fullName;
            document.getElementById('profileStudentId').textContent = learnerData.studentId;
            document.getElementById('profileEmail').textContent = learnerData.email;
            document.getElementById('profilePhone').textContent = learnerData.phone;
            document.getElementById('profileDob').textContent = learnerData.dateOfBirth;
            document.getElementById('profileGender').textContent = learnerData.gender;
            document.getElementById('profileMajor').textContent = learnerData.major;
            document.getElementById('profileYearLevel').textContent = learnerData.yearLevel;
            document.getElementById('profileGpa').textContent = learnerData.gpa;
            document.getElementById('profileCredits').textContent = learnerData.totalCredits;
            document.getElementById('profileTotalLessons').textContent = learnerData.totalLessons;
            document.getElementById('profileStudyHours').textContent = learnerData.studyHours;
            document.getElementById('profileUpcomingLessons').textContent = learnerData.upcomingLessons;
            document.getElementById('profileMemberSince').textContent = learnerData.memberSince;
            document.getElementById('profileLastLogin').textContent = learnerData.lastLogin;
        }

        function closeProfileModal() {
            console.log('Closing Profile Modal...');
            document.getElementById('profileModal').style.display = 'none';
        }

        function previewProfileImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const cameraIcon = input.parentElement.querySelector('i');
                    cameraIcon.style.display = 'none';
                    input.parentElement.style.backgroundImage = `url(${e.target.result})`;
                    input.parentElement.style.backgroundSize = 'cover';
                    input.parentElement.style.backgroundPosition = 'center';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Certificate Upload Management
        let certificateCount = 0;
        
        function addCertificateField() {
            certificateCount++;
            const certificatesSection = document.getElementById('certificates-section');
            const certificateDiv = document.createElement('div');
            certificateDiv.id = `certificate-${certificateCount}`;
            certificateDiv.style.cssText = 'display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; background: #fafafa;';
            
            certificateDiv.innerHTML = `
                <input type="file" name="certificate_${certificateCount}" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" 
                       style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 1.1rem;" required>
                <button type="button" onclick="removeCertificateField(${certificateCount})" 
                        style="background: #ff4444; color: white; border: none; border-radius: 4px; padding: 8px 12px; cursor: pointer; font-size: 1rem;">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            certificatesSection.appendChild(certificateDiv);
        }
        
        function removeCertificateField(id) {
            const certificateDiv = document.getElementById(`certificate-${id}`);
            if (certificateDiv) {
                certificateDiv.remove();
            }
        }

        // Status Tab Management
        function switchStatusTab(tabName) {
            // Hide all status content
            const statusContents = document.querySelectorAll('.status-content');
            statusContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            const statusTabs = document.querySelectorAll('.status-tab');
            statusTabs.forEach(tab => {
                tab.classList.remove('active');
                tab.style.background = '';
                tab.style.color = '';
                tab.style.boxShadow = '';
            });
            
            // Show selected content and activate tab
            const selectedContent = document.getElementById(`${tabName}Content`);
            const selectedTab = document.getElementById(`${tabName}Tab`);
            
            if (selectedContent) selectedContent.style.display = 'block';
            if (selectedTab) {
                selectedTab.classList.add('active');
                if (tabName === 'pending') {
                    selectedTab.style.background = 'var(--learner-primary)';
                    selectedTab.style.color = '#fff';
                    selectedTab.style.boxShadow = '0 2px 8px rgba(25, 118, 210, 0.3)';
                } else if (tabName === 'needsInfo') {
                    selectedTab.style.background = '#ffc107';
                    selectedTab.style.color = '#333';
                } else if (tabName === 'approved') {
                    selectedTab.style.background = '#4caf50';
                    selectedTab.style.color = '#fff';
                    // Load interview details when switching to approved tab
                    loadInterviewDetails();
                }
            }
        }

        // Form Validation
        function validateTutorForm() {
            console.log('Validating tutor form...');
            let isValid = true;
            
            // Validate GPA
            const gpa = parseFloat(document.getElementById('gpa').value);
            const gpaError = document.getElementById('gpa-error');
            if (!gpa || isNaN(gpa) || gpa < 0 || gpa > 4) {
                gpaError.style.display = 'block';
                gpaError.textContent = 'Please enter a valid GPA between 0 and 4';
                isValid = false;
            } else {
                gpaError.style.display = 'none';
            }
            
            // Validate Subjects
            const subjects = document.getElementById('subjects');
            const subjectsError = document.getElementById('subjects-error');
            if (!subjects.selectedOptions.length) {
                subjectsError.style.display = 'block';
                isValid = false;
            } else {
                subjectsError.style.display = 'none';
            }
            
            // Validate Experience
            const experience = document.getElementById('experience').value;
            const experienceError = document.getElementById('experience-error');
            if (!experience.trim()) {
                experienceError.style.display = 'block';
                isValid = false;
            } else {
                experienceError.style.display = 'none';
            }
            
            // Validate Schedule
            const scheduleCheckboxes = document.querySelectorAll('input[name="schedule"]:checked');
            const scheduleError = document.getElementById('schedule-error');
            if (scheduleCheckboxes.length === 0) {
                scheduleError.style.display = 'block';
                isValid = false;
            } else {
                scheduleError.style.display = 'none';
            }
            
            // Validate Certificates
            const certificateInputs = document.querySelectorAll('input[type="file"]');
            const certificatesError = document.getElementById('certificates-error');
            let hasCertificates = false;
            certificateInputs.forEach(input => {
                if (input.files && input.files.length > 0) {
                    hasCertificates = true;
                }
            });
            if (!hasCertificates) {
                certificatesError.style.display = 'block';
                isValid = false;
            } else {
                certificatesError.style.display = 'none';
            }
            
            // Validate Description
            const description = document.getElementById('description').value;
            const descriptionError = document.getElementById('description-error');
            if (!description.trim()) {
                descriptionError.style.display = 'block';
                isValid = false;
            } else {
                descriptionError.style.display = 'none';
            }
            
            console.log('Form validation result:', isValid);
            return isValid;
        }

        // Button State Management
        function showPreviewMode() {
            // Hide form inputs
            const formInputs = document.querySelectorAll('#tutorApplyForm input, #tutorApplyForm textarea, #tutorApplyForm select');
            formInputs.forEach(input => {
                input.style.display = 'none';
            });
            
            // Show preview content
            const previewContent = document.createElement('div');
            previewContent.id = 'previewContent';
            previewContent.innerHTML = `
                <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                    <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.8rem; font-weight: 600;">Application Preview</h4>
                    <div id="previewData"></div>
                </div>
            `;
            
            document.getElementById('tutorApplyForm').insertBefore(previewContent, document.getElementById('tutorApplyActions'));
            
            // Update buttons
            document.getElementById('saveTutorApplyBtn').style.display = 'none';
            document.getElementById('previewTutorApplyBtn').style.display = 'none';
            document.getElementById('editTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('submitTutorApplyBtn').style.display = 'inline-block';
        }
        
        function showEditMode() {
            // Show form inputs
            const formInputs = document.querySelectorAll('#tutorApplyForm input, #tutorApplyForm textarea, #tutorApplyForm select');
            formInputs.forEach(input => {
                input.style.display = '';
            });
            
            // Remove preview content
            const previewContent = document.getElementById('previewContent');
            if (previewContent) {
                previewContent.remove();
            }
            
            // Update buttons
            document.getElementById('saveTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('previewTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('editTutorApplyBtn').style.display = 'none';
            document.getElementById('submitTutorApplyBtn').style.display = 'none';
        }

        // Save and Preview Logic
        function saveTutorApplication() {
            console.log('Save button clicked!');
            if (!validateTutorForm()) {
                console.log('Form validation failed');
                return;
            }
            
            // Collect form data
            const gpaElement = document.getElementById('gpa');
            const subjectsElement = document.getElementById('subjects');
            const experienceElement = document.getElementById('experience');
            const descriptionElement = document.getElementById('description');
                
                const formData = {
                    id: 'app_' + Date.now(),
                    timestamp: new Date().toISOString(),
                    fullName: 'Nguyen Van A', // From learner info
                    studentId: '12345678',
                    email: 'student@vlu.edu.vn',
                    class: 'CTK43',
                    dateOfBirth: '01/01/2003',
                    phone: '0123456789',
                    gpa: gpaElement ? parseFloat(gpaElement.value) : 0,
                    subjects: subjectsElement ? Array.from(subjectsElement.selectedOptions).map(opt => opt.value) : [],
                    experience: experienceElement ? experienceElement.value : '',
                    schedule: Array.from(document.querySelectorAll('input[name="schedule"]:checked')).map(cb => cb.value),
                    certificates: getCertificateFiles(),
                    description: descriptionElement ? descriptionElement.value : '',
                    status: 'Pending'
                };
                
                localStorage.setItem('tutorApplication', JSON.stringify(formData));
                alert('Application saved successfully!');
        }
        
        function getCertificateFiles() {
            const certificateInputs = document.querySelectorAll('#certificates-section input[type="file"]');
            const files = [];
            certificateInputs.forEach(input => {
                if (input.files && input.files[0]) {
                    files.push(input.files[0].name);
                }
            });
            return files;
        }
        
        function previewTutorApplication() {
            console.log('Preview button clicked!');
            
            // Check if preview is already shown
            const existingPreview = document.getElementById('previewContent');
            if (existingPreview) {
                console.log('Preview already shown, switching to edit mode');
                showEditMode();
                return;
            }
            
            const savedData = JSON.parse(localStorage.getItem('tutorApplication'));
            if (!savedData) {
                console.log('No saved data found');
                alert('No saved data found. Please save your application first.');
                return;
            }
            
            if (!validateTutorForm()) {
                console.log('Form validation failed');
                return;
            }
            
            showPreviewMode(savedData);
        }
        
        function showPreviewMode(data) {
            console.log('Showing preview mode...');
            
            // Remove existing preview content first
            const existingPreview = document.getElementById('previewContent');
            if (existingPreview) {
                console.log('Removing existing preview content');
                existingPreview.remove();
            }
            
            // Hide form inputs
            const formInputs = document.querySelectorAll('#tutorApplyForm input, #tutorApplyForm textarea, #tutorApplyForm select');
            formInputs.forEach(input => {
                input.style.display = 'none';
            });
            
            // Show preview content
            const previewContent = document.createElement('div');
            previewContent.id = 'previewContent';
            previewContent.innerHTML = `
                <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                    <h4 style="color: var(--learner-primary); margin-bottom: 16px; font-size: 1.4rem; font-weight: 600;">Application Preview</h4>
                    <div id="previewData">
                        <div style="margin-bottom: 16px;">
                            <strong>GPA:</strong> ${data.gpa}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>Teaching Subjects:</strong> ${data.subjects.join(', ')}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>Teaching Experience:</strong> ${data.experience}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>Preferred Schedule:</strong> ${data.schedule.join(', ')}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>Certificates:</strong> ${data.certificates.join(', ')}
                        </div>
                        <div style="margin-bottom: 16px;">
                            <strong>Additional Description:</strong> ${data.description}
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('tutorApplyForm').insertBefore(previewContent, document.getElementById('tutorApplyActions'));
            
            // Update buttons
            document.getElementById('saveTutorApplyBtn').style.display = 'none';
            document.getElementById('previewTutorApplyBtn').style.display = 'none';
            document.getElementById('editTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('submitTutorApplyBtn').style.display = 'inline-block';
        }
        
        function showEditMode() {
            // Show form inputs
            const formInputs = document.querySelectorAll('#tutorApplyForm input, #tutorApplyForm textarea, #tutorApplyForm select');
            formInputs.forEach(input => {
                input.style.display = '';
            });
            
            // Remove preview content
            const previewContent = document.getElementById('previewContent');
            if (previewContent) {
                previewContent.remove();
            }
            
            // Restore saved data
            const savedData = JSON.parse(localStorage.getItem('tutorApplication'));
            if (savedData) {
                document.getElementById('gpa').value = savedData.gpa;
                // Restore subjects
                const subjectsSelect = document.getElementById('subjects');
                Array.from(subjectsSelect.options).forEach(option => {
                    option.selected = savedData.subjects.includes(option.value);
                });
                document.getElementById('experience').value = savedData.experience;
                // Restore schedule
                document.querySelectorAll('input[name="schedule"]').forEach(checkbox => {
                    checkbox.checked = savedData.schedule.includes(checkbox.value);
                });
                document.getElementById('description').value = savedData.description;
            }
            
            // Update buttons
            document.getElementById('saveTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('previewTutorApplyBtn').style.display = 'inline-block';
            document.getElementById('editTutorApplyBtn').style.display = 'none';
            document.getElementById('submitTutorApplyBtn').style.display = 'none';
        }
        
        function submitTutorApplication(e) {
            e.preventDefault();
            
            if (!validateTutorForm()) {
                return;
            }
            
            const savedData = JSON.parse(localStorage.getItem('tutorApplication'));
            if (!savedData) {
                alert('No application data to submit.');
                return;
            }
            
            // Add to applications list (simulate sending to server)
            const applications = JSON.parse(localStorage.getItem('tutorApplications') || '[]');
            applications.push(savedData);
            localStorage.setItem('tutorApplications', JSON.stringify(applications));
            
            // Clear current application
            localStorage.removeItem('tutorApplication');
            
            alert('Application submitted successfully!');
            closeApplyTutorModal();
        }

        // Interview Details and Reschedule Functions
        function loadInterviewDetails() {
            const applications = JSON.parse(localStorage.getItem('tutorApplications') || '[]');
            
            // Find the current learner's application (by studentId or fullName)
            const currentApplication = applications.find(app => 
                app.studentId === '12345678' || 
                app.fullName === 'Nguyen Van A' ||
                app.email === 'student@vlu.edu.vn'
            );
            
            if (currentApplication && currentApplication.status === 'Approved' && currentApplication.interviewDetails) {
                const interviewInfo = document.getElementById('interviewInfo');
                const interviewDetails = currentApplication.interviewDetails;
                
                interviewInfo.innerHTML = `
                    <div style="display: grid; gap: 12px;">
                        <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 8px;">
                            <i class="fas fa-calendar" style="color: #4caf50; font-size: 1.2rem;"></i>
                            <div>
                                <strong style="color: #333;">Date:</strong> ${formatDate(interviewDetails.date)}
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 8px;">
                            <i class="fas fa-clock" style="color: #4caf50; font-size: 1.2rem;"></i>
                            <div>
                                <strong style="color: #333;">Time:</strong> ${formatTime(interviewDetails.time)}
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: white; border-radius: 8px;">
                            <i class="fas fa-user-tie" style="color: #4caf50; font-size: 1.2rem; margin-top: 2px;"></i>
                            <div>
                                <strong style="color: #333;">Scheduled by:</strong> ${interviewDetails.scheduledBy}
                            </div>
                        </div>
                        ${interviewDetails.notes ? `
                        <div style="display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: white; border-radius: 8px;">
                            <i class="fas fa-sticky-note" style="color: #4caf50; font-size: 1.2rem; margin-top: 2px;"></i>
                            <div>
                                <strong style="color: #333;">Notes:</strong> ${interviewDetails.notes}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                // Load reschedule requests if any
                loadRescheduleStatus(currentApplication);
            } else {
                const interviewInfo = document.getElementById('interviewInfo');
                interviewInfo.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 12px;"></i>
                        <p>Interview details will be available once scheduled by the center.</p>
                    </div>
                `;
            }
        }
        
        function loadRescheduleStatus(application) {
            if (application.rescheduleRequests && application.rescheduleRequests.length > 0) {
                const rescheduleStatus = document.getElementById('rescheduleStatus');
                const rescheduleStatusContent = document.getElementById('rescheduleStatusContent');
                const latestRequest = application.rescheduleRequests[application.rescheduleRequests.length - 1];
                
                rescheduleStatusContent.innerHTML = `
                    <div style="background: white; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <strong style="color: #333;">Request Date:</strong> ${formatDateTime(latestRequest.requestedAt)}
                        </div>
                        <div style="margin-bottom: 8px;">
                            <strong style="color: #333;">Preferred Date:</strong> ${formatDate(latestRequest.requestedDate)}
                        </div>
                        <div style="margin-bottom: 8px;">
                            <strong style="color: #333;">Preferred Time:</strong> ${formatTime(latestRequest.requestedTime)}
                        </div>
                        <div style="margin-bottom: 12px;">
                            <strong style="color: #333;">Reason:</strong> ${latestRequest.reason}
                        </div>
                        <div style="padding: 8px 12px; border-radius: 6px; text-align: center; font-weight: 600; 
                             background: ${getStatusColor(latestRequest.status)}; color: white;">
                            Status: ${latestRequest.status}
                        </div>
                    </div>
                `;
                
                rescheduleStatus.style.display = 'block';
            } else {
                document.getElementById('rescheduleStatus').style.display = 'none';
            }
        }
        
        function submitRescheduleRequest() {
            const rescheduleDate = document.getElementById('rescheduleDate').value;
            const rescheduleTime = document.getElementById('rescheduleTime').value;
            const rescheduleReason = document.getElementById('applyRescheduleReason').value.trim();
            
            if (!rescheduleDate || !rescheduleTime || !rescheduleReason) {
                alert('Please fill in all required fields.');
                return;
            }
            
            // Add reschedule request to application
            const applications = JSON.parse(localStorage.getItem('tutorApplications') || '[]');
            const applicationIndex = applications.findIndex(app => 
                app.studentId === '12345678' || 
                app.fullName === 'Nguyen Van A' ||
                app.email === 'student@vlu.edu.vn'
            );
            
            if (applicationIndex !== -1) {
                if (!applications[applicationIndex].rescheduleRequests) {
                    applications[applicationIndex].rescheduleRequests = [];
                }
                
                applications[applicationIndex].rescheduleRequests.push({
                    requestedDate: rescheduleDate,
                    requestedTime: rescheduleTime,
                    reason: rescheduleReason,
                    requestedAt: new Date().toISOString(),
                    status: 'Pending'
                });
                
                localStorage.setItem('tutorApplications', JSON.stringify(applications));
                
                // Clear form
                document.getElementById('rescheduleDate').value = '';
                document.getElementById('rescheduleTime').value = '';
                document.getElementById('applyRescheduleReason').value = '';
                
                // Reload status
                loadRescheduleStatus(applications[applicationIndex]);
                
                alert('Reschedule request submitted successfully! The center will review your request.');
            } else {
                alert('No approved application found. Please ensure your application has been approved first.');
            }
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GB');
        }
        
        function formatTime(timeString) {
            const time = timeString.split(':');
            const hour = parseInt(time[0]);
            const minute = time[1];
            const period = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour > 12 ? hour - 12 : hour === 0 ? 12 : hour;
            return `${displayHour}:${minute} ${period}`;
        }
        
        function formatDateTime(dateTimeString) {
            const date = new Date(dateTimeString);
            return date.toLocaleDateString('en-GB') + ' ' + date.toLocaleTimeString('en-GB', {hour: '2-digit', minute: '2-digit'});
        }
        
        function getStatusColor(status) {
            switch(status) {
                case 'Pending': return '#ffc107';
                case 'Approved': return '#4caf50';
                case 'Rejected': return '#f44336';
                default: return '#666';
            }
        }

        // Find Tutor Functions
        function showFindTutorModal() {
            try {
                console.log('Opening Find Tutor Modal...');
                const modal = document.getElementById('findTutorModal');
                if (!modal) {
                    console.error('Modal element not found!');
                    alert('Error: Modal element not found. Please refresh the page.');
                    return;
                }
                
                modal.style.display = 'flex';
                console.log('Modal displayed successfully');
                
                // Load tutors immediately
                loadTutors();
                
            } catch (error) {
                console.error('Error opening modal:', error);
                alert('Error opening Find Tutor modal: ' + error.message);
            }
        }

        function closeFindTutorModal() {
            console.log('Closing Find Tutor Modal...');
            const modal = document.getElementById('findTutorModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // Demo tutor data
        const demoTutors = [
            {
                id: 1,
                name: "Dr. Sarah Johnson",
                subjects: ["mathematics", "physics"],
                rating: 4.9,
                totalReviews: 127,
                description: "Experienced mathematics and physics tutor with 8 years of teaching experience. Specializes in calculus, algebra, and mechanics.",
                certificates: ["PhD Mathematics", "Teaching Excellence Award"],
                badges: ["Expert Tutor", "Top Rated"],
                color: "#4CAF50",
                // Extended profile data
                accent: "American",
                positiveReviews: "98%",
                totalLessons: "1.2K",
                teachingLevels: ["Intermediate", "Upper Intermediate", "Advanced"],
                testFamiliarity: ["SAT", "ACT", "AP Calculus"],
                industryExperience: ["Education", "Research"],
                about: "Hi! I'm Sarah. I'm from the United States and I've been teaching mathematics and physics for eight years. I have a passion for making complex concepts simple and engaging. I love helping students discover the beauty of mathematics and physics through real-world applications. My teaching style focuses on building strong foundations and developing problem-solving skills.",
                specialties: ["Calculus", "Algebra", "Mechanics", "Thermodynamics"],
                experience: "8 years of teaching experience at university level. Published 15 research papers in applied mathematics. Led workshops for high school teachers on innovative teaching methods.",
                languages: ["English (Native)", "Spanish (Conversational)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["2:45 AM", "1:00 PM", "5:00 PM", "7:30 PM"],
                    "Tue July 29": ["9:00 AM", "3:30 PM", "6:00 PM"],
                    "Fri August 1": ["10:15 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["02:45", "13:00", "17:00", "19:30"], // Monday - like "Mon Tomorrow"
                    "2024-01-16": ["09:00", "15:30", "18:00"], // Tuesday - like "Tue July 29"
                    "2024-01-17": ["10:15", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:00", "14:00", "18:00"], // Thursday
                    "2024-01-19": ["10:15", "16:00", "20:00"], // Friday - like "Fri August 1"
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"], // Sunday
                    "2024-01-22": ["08:00", "12:00", "16:00"], // Next Monday
                    "2024-01-23": ["11:00", "15:00", "19:00"], // Next Tuesday
                    "2024-01-24": ["09:30", "14:30", "18:30"]  // Next Wednesday
                },
                reviews: [
                    { name: "Alex M.", rating: 5, comment: "Dr. Sarah made calculus so much easier to understand!", date: "2024-01-15" },
                    { name: "Maria K.", rating: 5, comment: "Excellent teacher! Very patient and explains concepts clearly.", date: "2024-01-10" },
                    { name: "John D.", rating: 4, comment: "Great physics tutor. Helped me improve my grades significantly.", date: "2024-01-05" }
                ]
            },
            {
                id: 2,
                name: "Prof. Michael Chen",
                subjects: ["cs", "mathematics"],
                rating: 4.8,
                totalReviews: 89,
                description: "Computer Science professor with expertise in programming, algorithms, and discrete mathematics.",
                certificates: ["PhD Computer Science", "Google Certified"],
                badges: ["Super Tutor"],
                color: "#2196F3",
                // Extended profile data
                accent: "American",
                positiveReviews: "96%",
                totalLessons: "890",
                teachingLevels: ["Beginner", "Intermediate", "Advanced"],
                testFamiliarity: ["AP Computer Science", "GRE", "Technical Interviews"],
                industryExperience: ["Technology", "Education"],
                about: "Hi! I'm Michael. I'm a Computer Science professor with over 10 years of experience in both academia and industry. I love teaching programming and helping students understand complex algorithms. My approach combines theoretical knowledge with practical applications.",
                specialties: ["Python", "Java", "Algorithms", "Data Structures"],
                experience: "10+ years teaching at top universities. Former software engineer at Google. Published 25+ papers in computer science education.",
                languages: ["English (Native)", "Mandarin (Fluent)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:30 PM"],
                    "Tue July 29": ["10:30 AM", "4:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "3:00 PM", "8:30 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:30"], // Monday
                    "2024-01-16": ["10:30", "16:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "15:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:15", "16:00", "20:00"], // Friday
                    "2024-01-20": ["09:00", "13:30", "17:30"], // Saturday
                    "2024-01-21": ["10:30", "14:30", "18:30"], // Sunday
                    "2024-01-22": ["08:30", "13:30", "17:30"], // Next Monday
                    "2024-01-23": ["10:00", "15:00", "19:00"], // Next Tuesday
                    "2024-01-24": ["11:30", "16:30", "20:30"]  // Next Wednesday
                },
                reviews: [
                    { name: "David L.", rating: 5, comment: "Professor Chen is amazing! He explains complex algorithms so clearly.", date: "2024-01-12" },
                    { name: "Sarah W.", rating: 4, comment: "Great programming tutor. Helped me ace my technical interviews.", date: "2024-01-08" }
                ]
            },
            {
                id: 3,
                name: "Dr. Emily Rodriguez",
                subjects: ["chemistry", "biology"],
                rating: 4.7,
                totalReviews: 156,
                description: "Chemistry and Biology specialist with research background in organic chemistry and molecular biology.",
                certificates: ["PhD Chemistry", "Research Excellence"],
                badges: ["Expert Tutor"],
                color: "#FF9800",
                // Extended profile data
                accent: "American",
                positiveReviews: "97%",
                totalLessons: "1.5K",
                teachingLevels: ["Intermediate", "Advanced"],
                testFamiliarity: ["AP Chemistry", "AP Biology", "MCAT"],
                industryExperience: ["Research", "Education"],
                about: "Hi! I'm Emily. I'm a Chemistry and Biology specialist with a strong research background in organic chemistry and molecular biology. I've been teaching for 6 years and love helping students understand the fascinating world of science. My teaching approach combines theoretical knowledge with hands-on laboratory experience.",
                specialties: ["Organic Chemistry", "Molecular Biology", "Biochemistry", "Cell Biology"],
                experience: "6 years teaching at research universities. Published 20+ papers in chemistry and biology journals. Led research projects in molecular biology.",
                languages: ["English (Native)", "Spanish (Fluent)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Tue July 29": ["9:30 AM", "2:30 PM", "6:30 PM"],
                    "Fri August 1": ["11:30 AM", "4:30 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["10:00", "15:00", "19:00"], // Monday
                    "2024-01-16": ["09:30", "14:30", "18:30"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["10:30", "15:30", "19:30"], // Thursday
                    "2024-01-19": ["09:00", "14:00", "18:00"], // Friday
                    "2024-01-20": ["10:00", "14:00", "18:00"], // Saturday
                    "2024-01-21": ["11:00", "15:00", "19:00"]  // Sunday
                },
                reviews: [
                    { name: "Lisa P.", rating: 5, comment: "Dr. Emily is fantastic! She made chemistry so much more interesting.", date: "2024-01-14" },
                    { name: "Mark T.", rating: 4, comment: "Great biology tutor. Very knowledgeable and patient.", date: "2024-01-09" },
                    { name: "Anna R.", rating: 5, comment: "Excellent teacher! Helped me understand complex concepts easily.", date: "2024-01-03" }
                ]
            },
            {
                id: 4,
                name: "Ms. Jennifer Lee",
                subjects: ["english"],
                rating: 4.9,
                totalReviews: 203,
                description: "English language expert with focus on literature, writing, and communication skills.",
                certificates: ["MA English Literature", "TESOL Certified"],
                badges: ["Top Rated", "Super Tutor"],
                color: "#9C27B0",
                // Extended profile data
                accent: "American",
                positiveReviews: "100%",
                totalLessons: "2K+",
                teachingLevels: ["All Levels"],
                testFamiliarity: ["Various"],
                industryExperience: ["Education"],
                about: "Hi! I'm Jennifer. I'm an English language expert with a passion for literature, writing, and communication skills. I've been teaching English for 7 years and love helping students improve their language skills. My teaching style is interactive and engaging, focusing on practical communication.",
                specialties: ["Literature", "Writing", "Communication", "Grammar"],
                experience: "7 years teaching English at language schools and universities. TESOL certified instructor. Published articles on language teaching methods.",
                languages: ["English (Native)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"]  // Sunday
                },
                reviews: [
                    { name: "Emma S.", rating: 5, comment: "Ms. Jennifer is the best English teacher I've ever had!", date: "2024-01-13" },
                    { name: "James B.", rating: 5, comment: "Excellent writing tutor. Helped me improve my essays significantly.", date: "2024-01-07" },
                    { name: "Sophie M.", rating: 4, comment: "Great communication skills tutor. Very patient and encouraging.", date: "2024-01-01" }
                ]
            },
            {
                id: 5,
                name: "Dr. Robert Wilson",
                subjects: ["physics", "mathematics"],
                rating: 4.6,
                totalReviews: 94,
                description: "Physics professor specializing in quantum mechanics, thermodynamics, and advanced mathematics.",
                certificates: ["PhD Physics", "Nobel Prize Nominee"],
                badges: ["Expert Tutor"],
                color: "#F44336",
                // Extended profile data
                accent: "British",
                positiveReviews: "95%",
                totalLessons: "940",
                teachingLevels: ["Advanced"],
                testFamiliarity: ["GRE Physics", "AP Physics", "University Exams"],
                industryExperience: ["Research", "Education"],
                about: "Hi! I'm Robert. I'm a Physics professor specializing in quantum mechanics, thermodynamics, and advanced mathematics. I've been teaching for 12 years and love exploring the fundamental laws of the universe with my students. My teaching approach focuses on deep understanding and mathematical rigor.",
                specialties: ["Quantum Mechanics", "Thermodynamics", "Advanced Mathematics", "Theoretical Physics"],
                experience: "12 years teaching at prestigious universities. Nobel Prize nominee for contributions to quantum physics. Published 30+ papers in top physics journals.",
                languages: ["English (Native)", "German (Conversational)"],
                studentPreferences: "Advanced students only",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["11:00 AM", "4:00 PM", "8:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["12:00 PM", "5:00 PM", "9:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["11:00", "16:00", "20:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["12:00", "17:00", "21:00"], // Wednesday
                    "2024-01-18": ["11:30", "16:30", "20:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["11:00", "15:00", "19:00"], // Saturday
                    "2024-01-21": ["12:00", "16:00", "20:00"]  // Sunday
                },
                reviews: [
                    { name: "Michael R.", rating: 5, comment: "Dr. Wilson is brilliant! His quantum mechanics explanations are crystal clear.", date: "2024-01-11" },
                    { name: "Sarah L.", rating: 4, comment: "Excellent physics tutor. Very thorough and patient.", date: "2024-01-06" }
                ]
            },
            {
                id: 6,
                name: "Mr. David Kim",
                subjects: ["cs", "economics"],
                rating: 4.5,
                totalReviews: 67,
                description: "Software engineer turned tutor with expertise in programming, data science, and economics.",
                certificates: ["MS Computer Science", "Data Science Certified"],
                badges: ["Rising Star"],
                color: "#607D8B",
                // Extended profile data
                accent: "American",
                positiveReviews: "94%",
                totalLessons: "670",
                teachingLevels: ["Beginner", "Intermediate"],
                testFamiliarity: ["Technical Interviews", "Data Science Certifications"],
                industryExperience: ["Technology", "Finance"],
                about: "Hi! I'm David. I'm a software engineer turned tutor with expertise in programming, data science, and economics. I love helping students bridge the gap between theory and practical applications. My teaching style is hands-on and project-based.",
                specialties: ["Programming", "Data Science", "Economics", "Machine Learning"],
                experience: "5 years as software engineer at tech companies. Data science consultant. Published articles on programming education.",
                languages: ["English (Native)", "Korean (Fluent)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["8:00 AM", "1:00 PM", "5:00 PM"],
                    "Tue July 29": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Fri August 1": ["10:00 AM", "3:00 PM", "7:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["08:00", "13:00", "17:00"], // Monday
                    "2024-01-16": ["09:00", "14:00", "18:00"], // Tuesday
                    "2024-01-17": ["10:00", "15:00", "19:00"], // Wednesday
                    "2024-01-18": ["08:30", "13:30", "17:30"], // Thursday
                    "2024-01-19": ["09:30", "14:30", "18:30"], // Friday
                    "2024-01-20": ["08:00", "12:00", "16:00"], // Saturday
                    "2024-01-21": ["09:00", "13:00", "17:00"]  // Sunday
                },
                reviews: [
                    { name: "Alex K.", rating: 4, comment: "Great programming tutor. Helped me understand complex concepts.", date: "2024-01-12" },
                    { name: "Jenny L.", rating: 5, comment: "Excellent data science teacher. Very practical approach.", date: "2024-01-08" }
                ]
            },
            {
                id: 7,
                name: "Dr. Lisa Thompson",
                subjects: ["biology", "chemistry"],
                rating: 4.8,
                totalReviews: 112,
                description: "Biologist with extensive experience in genetics, cell biology, and biochemistry.",
                certificates: ["PhD Biology", "Research Grant Winner"],
                badges: ["Expert Tutor", "Top Rated"],
                color: "#4CAF50",
                // Extended profile data
                accent: "American",
                positiveReviews: "96%",
                totalLessons: "1.1K",
                teachingLevels: ["Intermediate", "Advanced"],
                testFamiliarity: ["MCAT", "AP Biology", "GRE Biology"],
                industryExperience: ["Research", "Education"],
                about: "Hi! I'm Lisa. I'm a biologist with extensive experience in genetics, cell biology, and biochemistry. I've been teaching for 9 years and love helping students understand the complexity of life. My teaching approach combines cutting-edge research with fundamental concepts.",
                specialties: ["Genetics", "Cell Biology", "Biochemistry", "Molecular Biology"],
                experience: "9 years teaching at research institutions. Research grant winner. Published 18 papers in biology journals.",
                languages: ["English (Native)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:30 AM", "2:30 PM", "6:30 PM"],
                    "Tue July 29": ["10:30 AM", "3:30 PM", "7:30 PM"],
                    "Fri August 1": ["11:30 AM", "4:30 PM", "8:30 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:30", "14:30", "18:30"], // Monday
                    "2024-01-16": ["10:30", "15:30", "19:30"], // Tuesday
                    "2024-01-17": ["11:30", "16:30", "20:30"], // Wednesday
                    "2024-01-18": ["09:00", "14:00", "18:00"], // Thursday
                    "2024-01-19": ["10:00", "15:00", "19:00"], // Friday
                    "2024-01-20": ["09:30", "13:30", "17:30"], // Saturday
                    "2024-01-21": ["10:30", "14:30", "18:30"]  // Sunday
                },
                reviews: [
                    { name: "Tom B.", rating: 5, comment: "Dr. Thompson is amazing! Her genetics explanations are so clear.", date: "2024-01-10" },
                    { name: "Emma W.", rating: 4, comment: "Great biology tutor. Very knowledgeable and patient.", date: "2024-01-05" }
                ]
            },
            {
                id: 8,
                name: "Prof. James Anderson",
                subjects: ["economics", "mathematics"],
                rating: 4.7,
                totalReviews: 78,
                description: "Economics professor with strong mathematical background in statistics and econometrics.",
                certificates: ["PhD Economics", "Statistical Analysis Expert"],
                badges: ["Super Tutor"],
                color: "#795548",
                // Extended profile data
                accent: "British",
                positiveReviews: "95%",
                totalLessons: "780",
                teachingLevels: ["Intermediate", "Advanced"],
                testFamiliarity: ["GRE Economics", "GMAT", "University Exams"],
                industryExperience: ["Academia", "Consulting"],
                about: "Hi! I'm James. I'm an Economics professor with a strong mathematical background in statistics and econometrics. I've been teaching for 11 years and love helping students understand the intersection of economics and mathematics. My teaching style emphasizes analytical thinking and practical applications.",
                specialties: ["Econometrics", "Statistics", "Mathematical Economics", "Economic Modeling"],
                experience: "11 years teaching at top universities. Statistical analysis consultant. Published 22 papers in economics journals.",
                languages: ["English (Native)", "French (Conversational)"],
                studentPreferences: "Intermediate to advanced students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Tue July 29": ["11:00 AM", "4:00 PM", "8:00 PM"],
                    "Fri August 1": ["12:00 PM", "5:00 PM", "9:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["10:00", "15:00", "19:00"], // Monday
                    "2024-01-16": ["11:00", "16:00", "20:00"], // Tuesday
                    "2024-01-17": ["12:00", "17:00", "21:00"], // Wednesday
                    "2024-01-18": ["10:30", "15:30", "19:30"], // Thursday
                    "2024-01-19": ["11:30", "16:30", "20:30"], // Friday
                    "2024-01-20": ["10:00", "14:00", "18:00"], // Saturday
                    "2024-01-21": ["11:00", "15:00", "19:00"]  // Sunday
                },
                reviews: [
                    { name: "Chris M.", rating: 4, comment: "Professor Anderson is excellent at explaining complex economic concepts.", date: "2024-01-09" },
                    { name: "Laura S.", rating: 5, comment: "Great statistics tutor. Very thorough explanations.", date: "2024-01-04" }
                ]
            },
            {
                id: 9,
                name: "Ms. Amanda Foster",
                subjects: ["english", "cs"],
                rating: 4.4,
                totalReviews: 45,
                description: "Technical writer and English tutor with experience in programming documentation and communication.",
                certificates: ["BA English", "Technical Writing Certified"],
                badges: ["Rising Star"],
                color: "#E91E63",
                // Extended profile data
                accent: "American",
                positiveReviews: "93%",
                totalLessons: "450",
                teachingLevels: ["Beginner", "Intermediate"],
                testFamiliarity: ["TOEFL", "Technical Writing"],
                industryExperience: ["Technology", "Education"],
                about: "Hi! I'm Amanda. I'm a technical writer and English tutor with experience in programming documentation and communication. I love helping students improve their writing skills, especially in technical contexts. My teaching approach is practical and industry-focused.",
                specialties: ["Technical Writing", "English Grammar", "Programming Documentation", "Communication"],
                experience: "4 years as technical writer at software companies. English tutor for international students. Published technical documentation guides.",
                languages: ["English (Native)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"]  // Sunday
                },
                reviews: [
                    { name: "Mike T.", rating: 4, comment: "Great technical writing tutor. Very helpful with documentation.", date: "2024-01-08" },
                    { name: "Sarah K.", rating: 4, comment: "Excellent English teacher. Improved my communication skills.", date: "2024-01-03" }
                ]
            },
            {
                id: 10,
                name: "Dr. Thomas Brown",
                subjects: ["physics", "chemistry"],
                rating: 4.9,
                totalReviews: 189,
                description: "Physical chemist with expertise in thermodynamics, kinetics, and quantum chemistry.",
                certificates: ["PhD Physical Chemistry", "International Award Winner"],
                badges: ["Expert Tutor", "Super Tutor"],
                color: "#3F51B5",
                // Extended profile data
                accent: "American",
                positiveReviews: "98%",
                totalLessons: "1.8K",
                teachingLevels: ["Advanced"],
                testFamiliarity: ["GRE Chemistry", "Physical Chemistry Exams"],
                industryExperience: ["Research", "Education"],
                about: "Hi! I'm Thomas. I'm a physical chemist with expertise in thermodynamics, kinetics, and quantum chemistry. I've been teaching for 15 years and love exploring the fundamental principles that govern chemical reactions. My teaching approach emphasizes deep understanding and mathematical rigor.",
                specialties: ["Thermodynamics", "Kinetics", "Quantum Chemistry", "Physical Chemistry"],
                experience: "15 years teaching at research universities. International award winner for contributions to physical chemistry. Published 35+ papers in top chemistry journals.",
                languages: ["English (Native)", "Spanish (Conversational)"],
                studentPreferences: "Advanced students only",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["11:00 AM", "4:00 PM", "8:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["12:00 PM", "5:00 PM", "9:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["11:00", "16:00", "20:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["12:00", "17:00", "21:00"], // Wednesday
                    "2024-01-18": ["11:30", "16:30", "20:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["11:00", "15:00", "19:00"], // Saturday
                    "2024-01-21": ["12:00", "16:00", "20:00"]  // Sunday
                },
                reviews: [
                    { name: "David R.", rating: 5, comment: "Dr. Brown is exceptional! His thermodynamics explanations are brilliant.", date: "2024-01-12" },
                    { name: "Jennifer L.", rating: 5, comment: "Outstanding physical chemistry tutor. Very knowledgeable.", date: "2024-01-07" },
                    { name: "Robert M.", rating: 4, comment: "Great teacher. Helped me understand complex concepts.", date: "2024-01-02" }
                ]
            },
            {
                id: 11,
                name: "Ms. Rachel Green",
                subjects: ["mathematics", "economics"],
                rating: 4.6,
                totalReviews: 73,
                description: "Mathematics tutor with focus on applied mathematics, statistics, and economic modeling.",
                certificates: ["MS Mathematics", "Statistical Modeling Expert"],
                badges: ["Top Rated"],
                color: "#009688",
                // Extended profile data
                accent: "American",
                positiveReviews: "94%",
                totalLessons: "730",
                teachingLevels: ["Intermediate", "Advanced"],
                testFamiliarity: ["GRE Mathematics", "Statistics Exams"],
                industryExperience: ["Finance", "Education"],
                about: "Hi! I'm Rachel. I'm a mathematics tutor with focus on applied mathematics, statistics, and economic modeling. I love helping students see the practical applications of mathematics in real-world scenarios. My teaching style is interactive and problem-solving focused.",
                specialties: ["Applied Mathematics", "Statistics", "Economic Modeling", "Mathematical Finance"],
                experience: "7 years teaching mathematics and statistics. Statistical modeling consultant for financial institutions. Published articles on mathematical education.",
                languages: ["English (Native)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Tue July 29": ["11:00 AM", "4:00 PM", "8:00 PM"],
                    "Fri August 1": ["12:00 PM", "5:00 PM", "9:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["10:00", "15:00", "19:00"], // Monday
                    "2024-01-16": ["11:00", "16:00", "20:00"], // Tuesday
                    "2024-01-17": ["12:00", "17:00", "21:00"], // Wednesday
                    "2024-01-18": ["10:30", "15:30", "19:30"], // Thursday
                    "2024-01-19": ["11:30", "16:30", "20:30"], // Friday
                    "2024-01-20": ["10:00", "14:00", "18:00"], // Saturday
                    "2024-01-21": ["11:00", "15:00", "19:00"]  // Sunday
                },
                reviews: [
                    { name: "Kevin P.", rating: 4, comment: "Great statistics tutor. Very clear explanations.", date: "2024-01-09" },
                    { name: "Lisa M.", rating: 5, comment: "Excellent mathematical modeling teacher. Very practical approach.", date: "2024-01-04" }
                ]
            },
            {
                id: 12,
                name: "Dr. Kevin Martinez",
                subjects: ["cs", "physics"],
                rating: 4.8,
                totalReviews: 134,
                description: "Computer scientist with background in computational physics and machine learning.",
                certificates: ["PhD Computer Science", "AI/ML Specialist"],
                badges: ["Expert Tutor", "Super Tutor"],
                color: "#673AB7",
                // Extended profile data
                accent: "American",
                positiveReviews: "97%",
                totalLessons: "1.3K",
                teachingLevels: ["Intermediate", "Advanced"],
                testFamiliarity: ["Technical Interviews", "AI/ML Certifications"],
                industryExperience: ["Technology", "Research"],
                about: "Hi! I'm Kevin. I'm a computer scientist with background in computational physics and machine learning. I love exploring the intersection of computer science and physics. My teaching approach combines theoretical foundations with practical applications in AI and ML.",
                specialties: ["Machine Learning", "Computational Physics", "AI", "Data Science"],
                experience: "10 years in computer science research. AI/ML specialist at tech companies. Published 25+ papers in computer science and physics.",
                languages: ["English (Native)", "Spanish (Fluent)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"]  // Sunday
                },
                reviews: [
                    { name: "Alex T.", rating: 5, comment: "Dr. Martinez is brilliant! His ML explanations are crystal clear.", date: "2024-01-11" },
                    { name: "Maria S.", rating: 4, comment: "Excellent AI tutor. Very knowledgeable and patient.", date: "2024-01-06" }
                ]
            },
            {
                id: 13,
                name: "Ms. Sophia Wang",
                subjects: ["biology", "english"],
                rating: 4.5,
                totalReviews: 56,
                description: "Biology tutor with strong communication skills and experience in scientific writing.",
                certificates: ["MS Biology", "Science Communication Expert"],
                badges: ["Rising Star"],
                color: "#FF5722",
                // Extended profile data
                accent: "American",
                positiveReviews: "92%",
                totalLessons: "560",
                teachingLevels: ["Beginner", "Intermediate"],
                testFamiliarity: ["AP Biology", "Science Writing"],
                industryExperience: ["Education", "Science Communication"],
                about: "Hi! I'm Sophia. I'm a biology tutor with strong communication skills and experience in scientific writing. I love helping students understand biology while improving their writing skills. My teaching approach combines scientific rigor with clear communication.",
                specialties: ["Biology", "Scientific Writing", "Science Communication", "Research Methods"],
                experience: "4 years teaching biology and scientific writing. Science communication expert. Published articles on science education.",
                languages: ["English (Native)", "Mandarin (Fluent)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"]  // Sunday
                },
                reviews: [
                    { name: "Jake L.", rating: 4, comment: "Great biology tutor. Very clear explanations.", date: "2024-01-08" },
                    { name: "Emma R.", rating: 4, comment: "Excellent scientific writing teacher. Very helpful.", date: "2024-01-03" }
                ]
            },
            {
                id: 14,
                name: "Prof. Daniel Taylor",
                subjects: ["chemistry", "mathematics"],
                rating: 4.7,
                totalReviews: 98,
                description: "Chemistry professor with expertise in mathematical chemistry and computational modeling.",
                certificates: ["PhD Chemistry", "Computational Chemistry Expert"],
                badges: ["Expert Tutor"],
                color: "#8BC34A",
                // Extended profile data
                accent: "British",
                positiveReviews: "95%",
                totalLessons: "980",
                teachingLevels: ["Advanced"],
                testFamiliarity: ["GRE Chemistry", "Computational Chemistry"],
                industryExperience: ["Research", "Education"],
                about: "Hi! I'm Daniel. I'm a chemistry professor with expertise in mathematical chemistry and computational modeling. I love exploring the mathematical foundations of chemistry and helping students understand complex chemical systems through computational methods.",
                specialties: ["Mathematical Chemistry", "Computational Chemistry", "Chemical Modeling", "Quantum Chemistry"],
                experience: "13 years teaching chemistry and computational methods. Computational chemistry expert. Published 28 papers in chemistry and computational science.",
                languages: ["English (Native)", "German (Conversational)"],
                studentPreferences: "Advanced students only",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["11:00 AM", "4:00 PM", "8:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["12:00 PM", "5:00 PM", "9:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["11:00", "16:00", "20:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["12:00", "17:00", "21:00"], // Wednesday
                    "2024-01-18": ["11:30", "16:30", "20:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["11:00", "15:00", "19:00"], // Saturday
                    "2024-01-21": ["12:00", "16:00", "20:00"]  // Sunday
                },
                reviews: [
                    { name: "Mark S.", rating: 5, comment: "Professor Taylor is exceptional! His computational chemistry explanations are brilliant.", date: "2024-01-10" },
                    { name: "Anna L.", rating: 4, comment: "Great mathematical chemistry tutor. Very thorough.", date: "2024-01-05" }
                ]
            },
            {
                id: 15,
                name: "Dr. Maria Garcia",
                subjects: ["economics", "english"],
                rating: 4.9,
                totalReviews: 167,
                description: "Economics professor with excellent communication skills and international teaching experience.",
                certificates: ["PhD Economics", "International Teaching Award"],
                badges: ["Expert Tutor", "Top Rated", "Super Tutor"],
                color: "#FFC107",
                // Extended profile data
                accent: "Spanish",
                positiveReviews: "99%",
                totalLessons: "1.6K",
                teachingLevels: ["All Levels"],
                testFamiliarity: ["GRE Economics", "TOEFL", "IELTS"],
                industryExperience: ["International Education", "Consulting"],
                about: "Hi! I'm Maria. I'm an economics professor with excellent communication skills and international teaching experience. I love helping students from diverse backgrounds understand economics while improving their English skills. My teaching approach is inclusive and culturally sensitive.",
                specialties: ["Economics", "English Communication", "International Economics", "Economic Development"],
                experience: "14 years teaching economics internationally. International teaching award winner. Published 32 papers in economics and education.",
                languages: ["English (Fluent)", "Spanish (Native)", "French (Conversational)"],
                studentPreferences: "Open to new students",
                videoUrl: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                availability: {
                    "Mon Tomorrow": ["9:00 AM", "2:00 PM", "6:00 PM"],
                    "Tue July 29": ["10:00 AM", "3:00 PM", "7:00 PM"],
                    "Fri August 1": ["11:00 AM", "4:00 PM", "8:00 PM"]
                },
                weeklySchedule: {
                    "2024-01-15": ["09:00", "14:00", "18:00"], // Monday
                    "2024-01-16": ["10:00", "15:00", "19:00"], // Tuesday
                    "2024-01-17": ["11:00", "16:00", "20:00"], // Wednesday
                    "2024-01-18": ["09:30", "14:30", "18:30"], // Thursday
                    "2024-01-19": ["10:30", "15:30", "19:30"], // Friday
                    "2024-01-20": ["09:00", "13:00", "17:00"], // Saturday
                    "2024-01-21": ["10:00", "14:00", "18:00"]  // Sunday
                },
                reviews: [
                    { name: "Carlos M.", rating: 5, comment: "Dr. Garcia is amazing! Her international perspective is invaluable.", date: "2024-01-13" },
                    { name: "Isabella R.", rating: 5, comment: "Excellent economics and English tutor. Very patient and encouraging.", date: "2024-01-08" },
                    { name: "Lucas P.", rating: 4, comment: "Great teacher. Helped me improve both economics and English.", date: "2024-01-03" }
                ]
            }
        ];

        function loadTutors() {
            try {
                console.log('Loading tutors...');
                const tutorsGrid = document.getElementById('tutorsGrid');
                if (!tutorsGrid) {
                    console.error('Tutors grid element not found!');
                    return;
                }
                
                tutorsGrid.innerHTML = '';
                
                // Sort by rating by default
                const sortedTutors = [...demoTutors].sort((a, b) => b.rating - a.rating);
                console.log('Sorted tutors:', sortedTutors.length);
                
                sortedTutors.forEach(tutor => {
                    const tutorCard = createTutorCard(tutor);
                    tutorsGrid.appendChild(tutorCard);
                });
                
                updateTutorCount(demoTutors.length);
                updateFilterTags('', '', 0, false, false, false);
                console.log('Tutors loaded successfully');
                
            } catch (error) {
                console.error('Error loading tutors:', error);
                alert('Error loading tutors: ' + error.message);
            }
        }

        function createTutorCard(tutor) {
            const card = document.createElement('div');
            card.className = 'tutor-card';
            card.style.cssText = `
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                transition: transform 0.3s, box-shadow 0.3s;
                cursor: pointer;
            `;
            
            card.onmouseenter = () => {
                card.style.transform = 'translateY(-5px)';
                card.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
            };
            
            card.onmouseleave = () => {
                card.style.transform = 'translateY(0)';
                card.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
            };
            
            const badgesHtml = tutor.badges.map(badge => 
                `<span style="background: var(--learner-primary); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; margin-right: 5px;">${badge}</span>`
            ).join('');
            
            const certificatesHtml = tutor.certificates.map(cert => 
                `<div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <i class="fas fa-certificate" style="color: #ffc107; font-size: 0.9rem;"></i>
                    <span style="font-size: 0.9rem; color: #666;">${cert}</span>
                </div>`
            ).join('');
            
            card.innerHTML = `
                <div style="text-align: center; margin-bottom: 16px;">
                    <div style="width: 100%; height: 150px; background: ${tutor.color}; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem; font-weight: 600;">
                        <i class="fas fa-user-graduate" style="font-size: 3rem; margin-bottom: 8px;"></i>
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="font-size: 1rem;">${tutor.name.split(' ')[0]}</div>
                            <div style="font-size: 0.8rem; opacity: 0.9;">${tutor.name.split(' ').slice(1).join(' ')}</div>
                        </div>
                    </div>
                    <h3 style="color: var(--learner-primary); margin: 0 0 8px 0; font-size: 1.3rem;">${tutor.name}</h3>
                    <div style="margin-bottom: 12px;">
                        ${badgesHtml}
                    </div>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <i class="fas fa-star" style="color: #ffc107;"></i>
                        <span style="font-weight: 600; color: #333;">${tutor.rating}</span>
                        <span style="color: #666; font-size: 0.9rem;">(${tutor.totalReviews} reviews)</span>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <i class="fas fa-book" style="color: var(--learner-primary);"></i>
                        <span style="font-size: 0.9rem; color: #666;">${tutor.subjects.map(subject => subject.charAt(0).toUpperCase() + subject.slice(1)).join(', ')}</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <p style="color: #666; font-size: 0.9rem; line-height: 1.5; margin: 0;">${tutor.description}</p>
                </div>
                
                <div style="margin-bottom: 16px;">
                    <h4 style="color: #333; margin: 0 0 8px 0; font-size: 1rem;">Certificates & Awards:</h4>
                    ${certificatesHtml}
                </div>
                
                <div style="display: flex; gap: 8px;">
                    <button onclick="viewTutorProfile(${tutor.id})" style="width: 100%; background: var(--learner-primary); color: white; border: none; border-radius: 8px; padding: 12px; font-size: 1rem; cursor: pointer; transition: background 0.3s;">
                        <i class="fas fa-user"></i> View Profile
                    </button>
                </div>
            `;
            
            return card;
        }

        // Filter function for search
        function debounceFilter() {
            filterTutors();
        }

        function filterTutors() {
            const subjectFilter = document.getElementById('subjectFilter').value.toLowerCase();
            const nameFilter = document.getElementById('tutorNameFilter').value.toLowerCase();
            const ratingFilter = parseFloat(document.getElementById('ratingFilter').value) || 0;
            const sortFilter = document.getElementById('sortFilter').value;
            
            // Get checkbox filters
            const expertTutor = document.getElementById('expertTutor').checked;
            const superTutor = document.getElementById('superTutor').checked;
            const topRated = document.getElementById('topRated').checked;
            
            let filteredTutors = demoTutors.filter(tutor => {
                const matchesSubject = !subjectFilter || tutor.subjects.includes(subjectFilter);
                const matchesName = !nameFilter || tutor.name.toLowerCase().includes(nameFilter);
                const matchesRating = tutor.rating >= ratingFilter;
                
                // Check badge filters
                const matchesExpertTutor = !expertTutor || tutor.badges.includes('Expert Tutor');
                const matchesSuperTutor = !superTutor || tutor.badges.includes('Super Tutor');
                const matchesTopRated = !topRated || tutor.badges.includes('Top Rated');
                
                return matchesSubject && matchesName && matchesRating && 
                       matchesExpertTutor && matchesSuperTutor && matchesTopRated;
            });
            
            // Sort tutors
            filteredTutors.sort((a, b) => {
                switch(sortFilter) {
                    case 'rating':
                        return b.rating - a.rating;
                    case 'name':
                        return a.name.localeCompare(b.name);
                    case 'reviews':
                        return b.totalReviews - a.totalReviews;
                    default:
                        return 0;
                }
            });
            
            // Update active filter tags
            updateFilterTags(subjectFilter, nameFilter, ratingFilter, expertTutor, superTutor, topRated);
            
            // Show/hide empty state
            const emptyState = document.getElementById('emptyState');
            const tutorsGrid = document.getElementById('tutorsGrid');
            
            if (filteredTutors.length === 0) {
                tutorsGrid.style.display = 'none';
                emptyState.style.display = 'block';
            } else {
                tutorsGrid.style.display = 'grid';
                emptyState.style.display = 'none';
                
                tutorsGrid.innerHTML = '';
                filteredTutors.forEach(tutor => {
                    const tutorCard = createTutorCard(tutor);
                    tutorsGrid.appendChild(tutorCard);
                });
            }
            
            updateTutorCount(filteredTutors.length);
        }

        function updateFilterTags(subject, name, rating, expert, superTutor, topRated) {
            const filterTags = document.getElementById('filterTags');
            filterTags.innerHTML = '';
            
            const tags = [];
            
            if (subject) tags.push({ text: `Subject: ${subject}`, type: 'subject' });
            if (name) tags.push({ text: `Name: ${name}`, type: 'name' });
            if (rating > 0) tags.push({ text: `${rating}+ Stars`, type: 'rating' });
            if (expert) tags.push({ text: 'Expert Tutor', type: 'expert' });
            if (superTutor) tags.push({ text: 'Super Tutor', type: 'super' });
            if (topRated) tags.push({ text: 'Top Rated', type: 'topRated' });
            
            tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.style.cssText = `
                    background: var(--learner-primary);
                    color: white;
                    padding: 4px 8px;
                    border-radius: 12px;
                    font-size: 0.8rem;
                    display: flex;
                    align-items: center;
                    gap: 4px;
                    cursor: pointer;
                `;
                tagElement.innerHTML = `
                    ${tag.text}
                    <i class="fas fa-times" onclick="removeFilterTag('${tag.type}')"></i>
                `;
                filterTags.appendChild(tagElement);
            });
        }

        function removeFilterTag(type) {
            switch(type) {
                case 'subject':
                    document.getElementById('subjectFilter').value = '';
                    break;
                case 'name':
                    document.getElementById('tutorNameFilter').value = '';
                    break;
                case 'rating':
                    document.getElementById('ratingFilter').value = '0';
                    break;
                case 'expert':
                    document.getElementById('expertTutor').checked = false;
                    break;
                case 'super':
                    document.getElementById('superTutor').checked = false;
                    break;
                case 'topRated':
                    document.getElementById('topRated').checked = false;
                    break;
            }
            filterTutors();
        }

        function resetFilters() {
            document.getElementById('subjectFilter').value = '';
            document.getElementById('tutorNameFilter').value = '';
            document.getElementById('ratingFilter').value = '0';
            document.getElementById('expertTutor').checked = false;
            document.getElementById('superTutor').checked = false;
            document.getElementById('topRated').checked = false;
            document.getElementById('sortFilter').value = 'rating';
            loadTutors();
        }

        function toggleFullscreen() {
            const modal = document.getElementById('findTutorModal');
            const modalContent = modal.querySelector('.modal-content');
            const fullscreenBtn = modal.querySelector('button[onclick="toggleFullscreen()"]');
            
            if (modalContent.style.width === '100vw') {
                // Exit fullscreen
                modalContent.style.width = '95%';
                modalContent.style.maxWidth = '1400px';
                modalContent.style.height = '95vh';
                modalContent.style.maxHeight = '95vh';
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
            } else {
                // Enter fullscreen
                modalContent.style.width = '100vw';
                modalContent.style.maxWidth = '100vw';
                modalContent.style.height = '100vh';
                modalContent.style.maxHeight = '100vh';
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i> Exit Fullscreen';
            }
        }

        function toggleViewMode() {
            const tutorsGrid = document.getElementById('tutorsGrid');
            const viewToggle = document.getElementById('viewToggle');
            
            if (tutorsGrid.style.gridTemplateColumns.includes('1fr')) {
                // Switch to list view
                tutorsGrid.style.gridTemplateColumns = '1fr';
                tutorsGrid.style.gap = '12px';
                viewToggle.innerHTML = '<i class="fas fa-th"></i> Grid';
            } else {
                // Switch to grid view
                tutorsGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(300px, 1fr))';
                tutorsGrid.style.gap = '24px';
                viewToggle.innerHTML = '<i class="fas fa-list"></i> List';
            }
        }

        function updateTutorCount(count) {
            document.getElementById('tutorCount').textContent = count;
        }

        function viewTutorProfile(tutorId) {
            try {
                console.log('Opening profile for tutor ID:', tutorId);
                const tutor = demoTutors.find(t => t.id === tutorId);
                if (!tutor) {
                    console.error('Tutor not found:', tutorId);
                    return;
                }
                
                // Show modal
                const modal = document.getElementById('tutorProfileModal');
                modal.style.display = 'flex';
                
                // Load tutor data
                loadTutorProfileData(tutor);
                
            } catch (error) {
                console.error('Error opening tutor profile:', error);
                alert('Error opening tutor profile: ' + error.message);
            }
        }
        
        function closeTutorProfileModal() {
            const modal = document.getElementById('tutorProfileModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function loadTutorProfileData(tutor) {
            try {
                // Basic info
                document.getElementById('profileName').textContent = tutor.name;
                document.getElementById('profileAccent').textContent = tutor.accent || 'American';
                document.getElementById('profileRating').textContent = `${tutor.rating} (${tutor.positiveReviews || '100%'} positive)`;
                document.getElementById('profileLessons').textContent = tutor.totalLessons || '1K+ lessons';
                
                // Avatar
                const avatar = document.getElementById('profileAvatar');
                avatar.style.background = tutor.color;
                avatar.innerHTML = `<i class="fas fa-user-graduate"></i>`;
                
                // Stats
                document.getElementById('profileTeachingLevels').textContent = `Teaches: ${tutor.teachingLevels?.join(' | ') || 'All Levels'}`;
                document.getElementById('profileTestFamiliarity').textContent = `Test familiarity: ${tutor.testFamiliarity?.join(', ') || 'Various'}`;
                document.getElementById('profileIndustry').textContent = `Industry familiarity: ${tutor.industryExperience?.join(', ') || 'Education'}`;
                
                // About content
                document.getElementById('profileAbout').textContent = tutor.about || 'No description available.';
                document.getElementById('profilePreferences').textContent = tutor.studentPreferences || 'Open to new students';
                document.getElementById('profileExperience').textContent = tutor.experience || 'Experience details not available.';
                
                // Languages
                const languagesDiv = document.getElementById('profileLanguages');
                languagesDiv.innerHTML = '';
                if (tutor.languages) {
                    tutor.languages.forEach(lang => {
                        const button = document.createElement('button');
                        button.textContent = lang;
                        button.style.cssText = 'background: #e3f2fd; color: var(--learner-primary); border: 1px solid var(--learner-primary); border-radius: 6px; padding: 8px 16px; font-size: 0.9rem;';
                        languagesDiv.appendChild(button);
                    });
                }
                
                // Industry familiarity
                const industryDiv = document.getElementById('profileIndustryFamiliar');
                industryDiv.innerHTML = '';
                if (tutor.industryExperience) {
                    tutor.industryExperience.forEach(industry => {
                        const button = document.createElement('button');
                        button.textContent = industry;
                        button.style.cssText = 'background: #e3f2fd; color: var(--learner-primary); border: 1px solid var(--learner-primary); border-radius: 6px; padding: 8px 16px; font-size: 0.9rem;';
                        industryDiv.appendChild(button);
                    });
                }
                
                // Reviews
                const reviewsList = document.getElementById('reviewsList');
                reviewsList.innerHTML = '';
                if (tutor.reviews) {
                    tutor.reviews.forEach(review => {
                        const reviewDiv = document.createElement('div');
                        reviewDiv.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 16px;';
                        reviewDiv.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-weight: 500;">${review.name}</span>
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    ${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}
                                    <span style="color: #666; font-size: 0.9rem;">${review.date}</span>
                                </div>
                            </div>
                            <p style="color: #333; margin: 0;">${review.comment}</p>
                        `;
                        reviewsList.appendChild(reviewDiv);
                    });
                }
                
                // Specialties
                const specialtiesList = document.getElementById('specialtiesList');
                specialtiesList.innerHTML = '';
                if (tutor.specialties) {
                    tutor.specialties.forEach(specialty => {
                        const badge = document.createElement('span');
                        badge.textContent = specialty;
                        badge.style.cssText = 'background: var(--learner-primary); color: white; padding: 8px 16px; border-radius: 20px; font-size: 0.9rem;';
                        specialtiesList.appendChild(badge);
                    });
                }
                
                // Video
                const video = document.getElementById('profileVideo');
                const placeholder = document.getElementById('videoPlaceholder');
                if (tutor.videoUrl) {
                    video.src = tutor.videoUrl;
                    placeholder.style.display = 'none';
                } else {
                    placeholder.style.display = 'block';
                }
                
                // Booking section
                document.getElementById('bookingName').textContent = tutor.name;
                const bookingAvatar = document.getElementById('bookingAvatar');
                bookingAvatar.style.background = tutor.color;
                bookingAvatar.innerHTML = `<i class="fas fa-user-graduate"></i>`;
                
                // Calendar
                loadBookingCalendar(tutor);
                
            } catch (error) {
                console.error('Error loading tutor profile data:', error);
            }
        }
        
        function loadBookingCalendar(tutor) {
            const calendarDiv = document.getElementById('bookingCalendar');
            calendarDiv.innerHTML = '';
            
            if (tutor.availability) {
                const calendarContainer = document.createElement('div');
                calendarContainer.style.cssText = 'display: flex; gap: 12px; overflow-x: auto;';
                
                Object.entries(tutor.availability).forEach(([day, times]) => {
                    const dayColumn = document.createElement('div');
                    dayColumn.style.cssText = 'min-width: 120px;';
                    
                    const dayHeader = document.createElement('div');
                    dayHeader.textContent = day;
                    dayHeader.style.cssText = 'font-weight: 500; margin-bottom: 8px; color: #333;';
                    dayColumn.appendChild(dayHeader);
                    
                    times.forEach(time => {
                        const timeButton = document.createElement('button');
                        timeButton.textContent = time;
                        timeButton.style.cssText = 'width: 100%; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; margin-bottom: 4px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s;';
                        timeButton.onmouseover = () => timeButton.style.background = '#e3f2fd';
                        timeButton.onmouseout = () => timeButton.style.background = '#f8f9fa';
                        timeButton.onclick = () => alert(`Booking ${time} with ${tutor.name}`);
                        dayColumn.appendChild(timeButton);
                    });
                    
                    calendarContainer.appendChild(dayColumn);
                });
                
                calendarDiv.appendChild(calendarContainer);
            }
        }
        
        function switchProfileTab(tabName) {
            // Hide all tab contents
            document.getElementById('aboutContent').style.display = 'none';
            document.getElementById('reviewsContent').style.display = 'none';
            document.getElementById('specialtiesContent').style.display = 'none';
            document.getElementById('experienceContent').style.display = 'none';
            
            // Reset all tab buttons
            document.getElementById('tabAbout').style.color = '#666';
            document.getElementById('tabAbout').style.borderBottom = 'none';
            document.getElementById('tabReviews').style.color = '#666';
            document.getElementById('tabReviews').style.borderBottom = 'none';
            document.getElementById('tabSpecialties').style.color = '#666';
            document.getElementById('tabSpecialties').style.borderBottom = 'none';
            document.getElementById('tabExperience').style.color = '#666';
            document.getElementById('tabExperience').style.borderBottom = 'none';
            
            // Show selected tab content
            document.getElementById(tabName + 'Content').style.display = 'block';
            
            // Highlight selected tab button
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.color = 'var(--learner-primary)';
            document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.borderBottom = '3px solid var(--learner-primary)';
        }
        
        // Full Schedule Modal Functions
        let currentTutor = null;
        let currentWeekStart = new Date();
        let selectedDateTime = null;
        
        function showFullSchedule() {
            try {
                console.log('Opening full schedule modal...');
                const modal = document.getElementById('fullScheduleModal');
                modal.style.display = 'flex';
                
                // Get current tutor from profile modal
                currentTutor = getCurrentTutorFromProfile();
                if (!currentTutor) {
                    console.error('No tutor selected');
                    return;
                }
                
                // Initialize calendar
                initializeScheduleCalendar();
                
            } catch (error) {
                console.error('Error opening full schedule:', error);
                alert('Error opening schedule: ' + error.message);
            }
        }
        
        function closeFullScheduleModal() {
            const modal = document.getElementById('fullScheduleModal');
            if (modal) {
                modal.style.display = 'none';
                selectedDateTime = null;
            }
        }
        
        function getCurrentTutorFromProfile() {
            const tutorName = document.getElementById('profileName')?.textContent;
            if (tutorName) {
                return demoTutors.find(t => t.name === tutorName);
            }
            return null;
        }
        
        function initializeScheduleCalendar() {
            if (!currentTutor) return;
            
            // Set tutor name
            document.getElementById('scheduleTutorName').textContent = currentTutor.name + ' - Full Schedule';
            
            // Set current week
            currentWeekStart = new Date();
            currentWeekStart.setDate(currentWeekStart.getDate() - currentWeekStart.getDay() + 1); // Monday
            
            renderWeekCalendar();
        }
        
        function renderWeekCalendar() {
            const calendar = document.getElementById('weekCalendar');
            calendar.innerHTML = '';
            
            // Create a more compact layout with 3 columns like the image
            const calendarContainer = document.createElement('div');
            calendarContainer.style.cssText = 'display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; width: 100%;';
            
            // Create demo data for next 3 days with dynamic dates
            const availableDays = [];
            for (let i = 0; i < 3; i++) {
                const currentDate = new Date();
                currentDate.setDate(currentDate.getDate() + i);
                const dateString = currentDate.toISOString().split('T')[0];
                
                // Create demo time slots based on day
                const demoTimeSlots = [];
                if (i === 0) {
                    // Tomorrow - like "Mon Tomorrow"
                    demoTimeSlots.push("02:45", "13:00", "17:00", "19:30");
                } else if (i === 1) {
                    // Day after tomorrow - like "Tue July 29"
                    demoTimeSlots.push("09:00", "15:30", "18:00");
                } else {
                    // Third day - like "Fri August 1"
                    demoTimeSlots.push("10:15", "16:00", "20:00");
                }
                
                availableDays.push({
                    date: currentDate,
                    dateString: dateString,
                    timeSlots: demoTimeSlots
                });
            }
            
            availableDays.forEach((dayData, index) => {
                const currentDate = dayData.date;
                const dateString = dayData.dateString;
                const timeSlots = dayData.timeSlots;
                
                // Format day name dynamically
                const dayName = currentDate.toLocaleDateString('en-US', { weekday: 'short' });
                const monthName = currentDate.toLocaleDateString('en-US', { month: 'short' });
                const dayNumber = currentDate.getDate();
                
                let dayDisplayName = '';
                if (index === 0) {
                    dayDisplayName = `${dayName} Tomorrow`;
                } else {
                    dayDisplayName = `${dayName} ${monthName} ${dayNumber}`;
                }
                
                const dayColumn = document.createElement('div');
                dayColumn.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 16px; min-height: 250px;';
                
                // Day header
                const dayHeader = document.createElement('div');
                dayHeader.style.cssText = 'text-align: center; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;';
                dayHeader.innerHTML = `
                    <div style="font-weight: 600; color: var(--learner-primary); font-size: 1.1rem;">${dayDisplayName}</div>
                `;
                dayColumn.appendChild(dayHeader);
                
                // Time slots
                if (timeSlots.length > 0) {
                    timeSlots.forEach(time => {
                        const timeButton = document.createElement('button');
                        
                        // Convert 24-hour format to 12-hour format with AM/PM
                        const timeDisplay = convertTo12HourFormat(time);
                        timeButton.textContent = timeDisplay;
                        
                        timeButton.style.cssText = 'width: 100%; background: #e3f2fd; color: var(--learner-primary); border: 1px solid var(--learner-primary); border-radius: 6px; padding: 10px; margin-bottom: 8px; font-size: 0.9rem; cursor: pointer; transition: all 0.2s;';
                        
                        timeButton.onmouseover = () => {
                            if (!timeButton.classList.contains('selected')) {
                                timeButton.style.background = '#bbdefb';
                            }
                        };
                        timeButton.onmouseout = () => {
                            if (!timeButton.classList.contains('selected')) {
                                timeButton.style.background = '#e3f2fd';
                            }
                        };
                        timeButton.onclick = () => selectTimeSlot(dateString, time, dayDisplayName, currentDate.getDate(), currentDate.toLocaleDateString('en-US', { month: 'short' }));
                        
                        dayColumn.appendChild(timeButton);
                    });
                } else {
                    const noSlots = document.createElement('div');
                    noSlots.textContent = 'No available slots';
                    noSlots.style.cssText = 'text-align: center; color: #999; font-style: italic; padding: 20px 0;';
                    dayColumn.appendChild(noSlots);
                }
                
                calendarContainer.appendChild(dayColumn);
            });
            
            calendar.appendChild(calendarContainer);
            
            // Update week range display with current date
            const today = new Date();
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay() + 1); // Monday
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6); // Sunday
            
            const startDate = weekStart.toLocaleDateString('en-US', { month: 'long', day: 'numeric' });
            const endDate = weekEnd.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            document.getElementById('scheduleWeekRange').textContent = `Week of ${startDate} - ${endDate}`;
        }
        
        function selectTimeSlot(dateString, time, dayName, dayNumber, monthName) {
            selectedDateTime = { dateString, time, dayName, dayNumber, monthName };
            
            // Update booking section
            document.getElementById('selectedDate').textContent = `${dayName}`;
            document.getElementById('selectedTime').textContent = convertTo12HourFormat(time);
            
            // Show booking section
            document.getElementById('bookingSection').style.display = 'block';
            
            // Highlight selected slot
            const allButtons = document.querySelectorAll('#weekCalendar button');
            allButtons.forEach(btn => {
                btn.style.background = '#e3f2fd';
                btn.style.border = '1px solid var(--learner-primary)';
                btn.style.color = 'var(--learner-primary)';
                btn.classList.remove('selected');
            });
            
            // Find and highlight selected button
            const selectedButton = Array.from(allButtons).find(btn => 
                btn.textContent === convertTo12HourFormat(time) && 
                btn.closest('div').querySelector('div').textContent === dayName
            );
            if (selectedButton) {
                selectedButton.style.background = '#4caf50';
                selectedButton.style.color = 'white';
                selectedButton.style.border = '1px solid #4caf50';
                selectedButton.classList.add('selected');
            }
        }
        
        function bookSelectedSession() {
            if (!selectedDateTime || !currentTutor) {
                alert('Please select a time slot first');
                return;
            }
            
            try {
                // Create lesson object
                const lesson = {
                    id: `lesson_${Date.now()}`,
                    tutorId: currentTutor.id,
                    tutorName: currentTutor.name,
                    subject: currentTutor.subjects.join(', '),
                    date: selectedDateTime.dateString,
                    time: selectedDateTime.time,
                    duration: 60,
                    status: 'confirmed',
                    meetingLink: `https://meet.google.com/${Math.random().toString(36).substr(2, 9)}`,
                    createdAt: new Date().toISOString()
                };
                
                // Save to localStorage
                saveLessonToMySchedule(lesson);
                
                // Show success message
                alert(`Successfully booked lesson with ${currentTutor.name} on ${selectedDateTime.dayName}, ${selectedDateTime.monthName} ${selectedDateTime.dayNumber} at ${selectedDateTime.time}`);
                
                // Close modal
                closeFullScheduleModal();
                
            } catch (error) {
                console.error('Error booking session:', error);
                alert('Error booking session: ' + error.message);
            }
        }
        
        function saveLessonToMySchedule(lesson) {
            try {
                const existingSchedule = JSON.parse(localStorage.getItem('mySchedule') || '{"studentId": "12345678", "lessons": []}');
                existingSchedule.lessons.push(lesson);
                localStorage.setItem('mySchedule', JSON.stringify(existingSchedule));
                console.log('Lesson saved to My Schedule:', lesson);
            } catch (error) {
                console.error('Error saving lesson:', error);
            }
        }
        
        function previousWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() - 7);
            renderWeekCalendar();
            document.getElementById('bookingSection').style.display = 'none';
            selectedDateTime = null;
        }
        
        function currentWeek() {
            currentWeekStart = new Date();
            currentWeekStart.setDate(currentWeekStart.getDate() - currentWeekStart.getDay() + 1);
            renderWeekCalendar();
            document.getElementById('bookingSection').style.display = 'none';
            selectedDateTime = null;
        }
        
        function nextWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() + 7);
            renderWeekCalendar();
            document.getElementById('bookingSection').style.display = 'none';
            selectedDateTime = null;
        }
        
        // Utility function to convert 24-hour format to 12-hour format
        function convertTo12HourFormat(time24) {
            const [hours, minutes] = time24.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            return `${hour12}:${minutes} ${ampm}`;
        }
        
        // My Schedule Modal Functions
        let myScheduleWeekStart = new Date();
        
        function showMyScheduleModal() {
            try {
                console.log('Opening My Schedule modal...');
                const modal = document.getElementById('myScheduleModal');
                modal.style.display = 'flex';
                console.log('My Schedule Modal opened successfully');
                
                // Initialize calendar
                initializeMyScheduleCalendar();
                
            } catch (error) {
                console.error('Error opening My Schedule:', error);
                alert('Error opening My Schedule: ' + error.message);
            }
        }
        
        function closeMyScheduleModal() {
            console.log('Closing My Schedule Modal...');
            const modal = document.getElementById('myScheduleModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function initializeMyScheduleCalendar() {
            // Set current week
            myScheduleWeekStart = new Date();
            myScheduleWeekStart.setDate(myScheduleWeekStart.getDate() - myScheduleWeekStart.getDay() + 1); // Monday
            
            renderMyScheduleWeekCalendar();
            loadUpcomingLessons();
        }
        
        function renderMyScheduleWeekCalendar() {
            const calendar = document.getElementById('myScheduleWeekCalendar');
            calendar.innerHTML = '';
            
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const mySchedule = JSON.parse(localStorage.getItem('mySchedule') || '{"studentId": "12345678", "lessons": []}');
            
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(myScheduleWeekStart);
                currentDate.setDate(myScheduleWeekStart.getDate() + i);
                
                const dateString = currentDate.toISOString().split('T')[0];
                const dayName = days[i];
                const dayNumber = currentDate.getDate();
                const monthName = currentDate.toLocaleDateString('en-US', { month: 'short' });
                
                // Get lessons for this day
                const dayLessons = mySchedule.lessons.filter(lesson => lesson.date === dateString);
                
                const dayDiv = document.createElement('div');
                dayDiv.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 16px; min-height: 200px;';
                
                // Day header
                const dayHeader = document.createElement('div');
                dayHeader.style.cssText = 'text-align: center; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;';
                dayHeader.innerHTML = `
                    <div style="font-weight: 600; color: var(--learner-primary);">${dayName}</div>
                    <div style="font-size: 1.2rem; font-weight: 700; color: #333;">${dayNumber}</div>
                    <div style="font-size: 0.8rem; color: #666;">${monthName}</div>
                `;
                dayDiv.appendChild(dayHeader);
                
                // Lessons for this day
                if (dayLessons.length > 0) {
                    dayLessons.forEach(lesson => {
                        const lessonDiv = document.createElement('div');
                        lessonDiv.style.cssText = 'background: #e3f2fd; border: 1px solid var(--learner-primary); border-radius: 6px; padding: 8px; margin-bottom: 4px;';
                        lessonDiv.innerHTML = `
                            <div style="font-weight: 500; color: var(--learner-primary); font-size: 0.9rem;">${lesson.time}</div>
                            <div style="font-size: 0.8rem; color: #666;">${lesson.tutorName}</div>
                            <div style="font-size: 0.8rem; color: #666;">${lesson.subject}</div>
                        `;
                        dayDiv.appendChild(lessonDiv);
                    });
                } else {
                    const noLessons = document.createElement('div');
                    noLessons.textContent = 'No lessons';
                    noLessons.style.cssText = 'text-align: center; color: #999; font-size: 0.8rem; font-style: italic; padding: 20px 0;';
                    dayDiv.appendChild(noLessons);
                }
                
                calendar.appendChild(dayDiv);
            }
            
            // Update week range display
            const weekEnd = new Date(myScheduleWeekStart);
            weekEnd.setDate(myScheduleWeekStart.getDate() + 6);
            
            const startDate = myScheduleWeekStart.toLocaleDateString('en-US', { month: 'long', day: 'numeric' });
            const endDate = weekEnd.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            document.getElementById('myScheduleWeekRange').textContent = `Week of ${startDate} - ${endDate}`;
        }
        
        function loadUpcomingLessons() {
            const upcomingLessonsDiv = document.getElementById('upcomingLessons');
            upcomingLessonsDiv.innerHTML = '';
            
            const mySchedule = JSON.parse(localStorage.getItem('mySchedule') || '{"studentId": "12345678", "lessons": []}');
            
            // Sort lessons by date and time
            const sortedLessons = mySchedule.lessons.sort((a, b) => {
                const dateA = new Date(`${a.date}T${a.time}`);
                const dateB = new Date(`${b.date}T${b.time}`);
                return dateA - dateB;
            });
            
            if (sortedLessons.length === 0) {
                const noLessons = document.createElement('div');
                noLessons.style.cssText = 'text-align: center; color: #999; font-style: italic; padding: 40px 20px;';
                noLessons.innerHTML = `
                    <i class="fas fa-calendar-times" style="font-size: 2rem; margin-bottom: 16px; display: block;"></i>
                    <p>No upcoming lessons</p>
                    <p style="font-size: 0.9rem;">Book your first lesson to get started!</p>
                `;
                upcomingLessonsDiv.appendChild(noLessons);
                return;
            }
            
            sortedLessons.forEach(lesson => {
                const lessonCard = document.createElement('div');
                lessonCard.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 16px;';
                
                const lessonDate = new Date(lesson.date);
                const dayName = lessonDate.toLocaleDateString('en-US', { weekday: 'short' });
                const monthName = lessonDate.toLocaleDateString('en-US', { month: 'short' });
                const dayNumber = lessonDate.getDate();
                
                lessonCard.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                        <div>
                            <div style="font-weight: 600; color: #333; font-size: 1.1rem;">${lesson.tutorName}</div>
                            <div style="color: #666; font-size: 0.9rem;">${lesson.subject}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 500; color: var(--learner-primary);">${dayName}, ${monthName} ${dayNumber}</div>
                            <div style="color: #666; font-size: 0.9rem;">${lesson.time}</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button onclick="joinLesson('${lesson.id}')" style="flex: 1; background: var(--learner-primary); color: white; border: none; border-radius: 6px; padding: 8px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#1565c0'" onmouseout="this.style.background='var(--learner-primary)'">
                            <i class="fas fa-video"></i> Join
                        </button>
                        <button onclick="showRescheduleModal('${lesson.id}')" style="flex: 1; background: #ff9800; color: white; border: none; border-radius: 6px; padding: 8px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#f57c00'" onmouseout="this.style.background='#ff9800'">
                            <i class="fas fa-clock"></i> Reschedule
                        </button>
                    </div>
                `;
                
                upcomingLessonsDiv.appendChild(lessonCard);
            });
        }
        
        function joinLesson(lessonId) {
            // Redirect to lesson.html
            window.open('lesson.html', '_blank');
        }
        
        function showRescheduleModal(lessonId) {
            try {
                console.log('Opening reschedule modal for lesson:', lessonId);
                const modal = document.getElementById('rescheduleModal');
                modal.style.display = 'flex';
                
                // Reset form fields
                const reasonElement = document.getElementById('rescheduleReason');
                if (reasonElement) {
                    reasonElement.value = '';
                }
                
                // Clear selected time display
                const selectedTimeDisplay = document.getElementById('selectedTimeDisplay');
                if (selectedTimeDisplay) {
                    selectedTimeDisplay.style.display = 'none';
                }
                
                // Get lesson details
                const mySchedule = JSON.parse(localStorage.getItem('mySchedule') || '{"studentId": "12345678", "lessons": []}');
                const lesson = mySchedule.lessons.find(l => l.id === lessonId);
                
                if (!lesson) {
                    alert('Lesson not found');
                    return;
                }
                
                // Set current lesson info
                const lessonDate = new Date(lesson.date);
                const dayName = lessonDate.toLocaleDateString('en-US', { weekday: 'long' });
                const monthName = lessonDate.toLocaleDateString('en-US', { month: 'long' });
                const dayNumber = lessonDate.getDate();
                
                document.getElementById('rescheduleCurrentInfo').textContent = `Current: ${dayName}, ${monthName} ${dayNumber} at ${lesson.time}`;
                
                // Initialize reschedule calendar
                initializeRescheduleCalendar(lesson);
                
            } catch (error) {
                console.error('Error opening reschedule modal:', error);
                alert('Error opening reschedule modal: ' + error.message);
            }
        }
        
        function closeRescheduleModal() {
            const modal = document.getElementById('rescheduleModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        let currentRescheduleLesson = null;
        let selectedRescheduleDateTime = null;
        
        function initializeRescheduleCalendar(lesson) {
            currentRescheduleLesson = lesson;
            
            // Get tutor's available schedule
            const tutor = demoTutors.find(t => t.id === lesson.tutorId);
            if (!tutor) {
                alert('Tutor not found');
                return;
            }
            
            // Generate calendar for next 14 days
            const calendar = document.getElementById('rescheduleCalendar');
            calendar.innerHTML = '';
            
            const startDate = new Date();
            startDate.setDate(startDate.getDate() + 1); // Start from tomorrow
            
            for (let i = 0; i < 14; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                const dateString = currentDate.toISOString().split('T')[0];
                const dayName = currentDate.toLocaleDateString('en-US', { weekday: 'short' });
                const dayNumber = currentDate.getDate();
                const monthName = currentDate.toLocaleDateString('en-US', { month: 'short' });
                
                // Check if it's today or tomorrow for special styling
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(today.getDate() + 1);
                
                let dayLabel = dayName;
                if (currentDate.toDateString() === tomorrow.toDateString()) {
                    dayLabel = 'Tomorrow';
                } else if (currentDate.toDateString() === today.toDateString()) {
                    dayLabel = 'Today';
                }
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                dayDiv.dataset.date = dateString;
                dayDiv.dataset.dayNumber = dayNumber;
                dayDiv.style.cssText = `
                    background: white; 
                    border: 2px solid #e0e0e0; 
                    border-radius: 8px; 
                    padding: 12px; 
                    text-align: center; 
                    cursor: pointer; 
                    transition: all 0.3s ease;
                    position: relative;
                    min-height: 60px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                `;
                
                dayDiv.innerHTML = `
                    <div style="font-weight: 600; color: #333; font-size: 0.8rem; margin-bottom: 4px;">${dayLabel}</div>
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--learner-primary);">${dayNumber}</div>
                    <div style="font-size: 0.7rem; color: #666;">${monthName}</div>
                    <div style="position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background: #e0e0e0; border-radius: 50%; opacity: 0; transition: opacity 0.3s;"></div>
                `;
                
                // Hover effects
                dayDiv.onmouseover = () => {
                    dayDiv.style.background = '#f8f9fa';
                    dayDiv.style.borderColor = '#1976d2';
                    dayDiv.style.transform = 'translateY(-2px)';
                    dayDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
                };
                
                dayDiv.onmouseout = () => {
                    if (!dayDiv.classList.contains('selected')) {
                        dayDiv.style.background = 'white';
                        dayDiv.style.borderColor = '#e0e0e0';
                        dayDiv.style.transform = 'translateY(0)';
                        dayDiv.style.boxShadow = 'none';
                    }
                };
                
                dayDiv.onclick = () => selectRescheduleDate(dateString, dayLabel, dayNumber, monthName, tutor);
                
                calendar.appendChild(dayDiv);
            }
        }
        
        function selectRescheduleDate(dateString, dayName, dayNumber, monthName, tutor) {
            selectedRescheduleDateTime = { dateString, dayName, dayNumber, monthName };
            
            // Generate demo time slots for the selected date (front-end only)
            const demoTimeSlots = [
                '09:00 AM', '10:30 AM', '02:00 PM', '03:30 PM', '05:00 PM', '06:30 PM', '08:00 PM'
            ];
            
            const timeSlotsDiv = document.getElementById('rescheduleTimeSlots');
            timeSlotsDiv.innerHTML = '';
            
            // Add header
            const headerDiv = document.createElement('div');
            headerDiv.style.cssText = 'font-weight: 600; color: #333; margin-bottom: 12px; font-size: 1rem;';
            headerDiv.textContent = `Available times for ${dayName}, ${monthName} ${dayNumber}`;
            timeSlotsDiv.appendChild(headerDiv);
            
            // Create time slot buttons
            demoTimeSlots.forEach(time => {
                const timeButton = document.createElement('button');
                timeButton.className = 'time-slot-btn';
                timeButton.textContent = time;
                timeButton.style.cssText = `
                    background: #e3f2fd; 
                    color: var(--learner-primary); 
                    border: 2px solid var(--learner-primary); 
                    border-radius: 8px; 
                    padding: 10px 16px; 
                    font-size: 0.9rem; 
                    cursor: pointer; 
                    transition: all 0.3s ease;
                    margin: 4px;
                    min-width: 100px;
                `;
                
                // Hover effects
                timeButton.onmouseover = () => {
                    if (!timeButton.classList.contains('selected')) {
                        timeButton.style.background = '#bbdefb';
                        timeButton.style.transform = 'translateY(-1px)';
                        timeButton.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                    }
                };
                
                timeButton.onmouseout = () => {
                    if (!timeButton.classList.contains('selected')) {
                        timeButton.style.background = '#e3f2fd';
                        timeButton.style.transform = 'translateY(0)';
                        timeButton.style.boxShadow = 'none';
                    }
                };
                
                timeButton.onclick = () => selectRescheduleTime(time, timeButton);
                
                timeSlotsDiv.appendChild(timeButton);
            });
            
            // Highlight selected date with better visual feedback
            const allDateButtons = document.querySelectorAll('#rescheduleCalendar .calendar-day');
            allDateButtons.forEach(btn => {
                btn.classList.remove('selected');
                btn.style.background = 'white';
                btn.style.borderColor = '#e0e0e0';
                btn.style.color = 'inherit';
                btn.style.transform = 'translateY(0)';
                btn.style.boxShadow = 'none';
                
                // Reset the dot indicator
                const dot = btn.querySelector('div:last-child');
                if (dot) dot.style.opacity = '0';
            });
            
            const selectedButton = Array.from(allDateButtons).find(btn => 
                btn.dataset.dayNumber === dayNumber.toString()
            );
            
            if (selectedButton) {
                selectedButton.classList.add('selected');
                selectedButton.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
                selectedButton.style.borderColor = '#ff9800';
                selectedButton.style.color = 'white';
                selectedButton.style.transform = 'translateY(-3px)';
                selectedButton.style.boxShadow = '0 6px 20px rgba(255, 152, 0, 0.3)';
                
                // Show the dot indicator
                const dot = selectedButton.querySelector('div:last-child');
                if (dot) {
                    dot.style.background = '#fff';
                    dot.style.opacity = '1';
                }
            }
            
            // Clear any previously selected time
            selectedRescheduleDateTime.time = null;
        }
        
        function selectRescheduleTime(time, timeButton) {
            if (selectedRescheduleDateTime) {
                selectedRescheduleDateTime.time = time;
            }
            
            // Highlight selected time with better visual feedback
            const allTimeButtons = document.querySelectorAll('#rescheduleTimeSlots .time-slot-btn');
            allTimeButtons.forEach(btn => {
                btn.classList.remove('selected');
                btn.style.background = '#e3f2fd';
                btn.style.borderColor = 'var(--learner-primary)';
                btn.style.color = 'var(--learner-primary)';
                btn.style.transform = 'translateY(0)';
                btn.style.boxShadow = 'none';
            });
            
            if (timeButton) {
                timeButton.classList.add('selected');
                timeButton.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
                timeButton.style.borderColor = '#ff9800';
                timeButton.style.color = 'white';
                timeButton.style.transform = 'translateY(-2px)';
                timeButton.style.boxShadow = '0 4px 12px rgba(255, 152, 0, 0.3)';
            }
            
            // Update the selected time display
            const selectedTimeDisplay = document.getElementById('selectedTimeDisplay');
            if (selectedTimeDisplay) {
                selectedTimeDisplay.textContent = `Selected: ${selectedRescheduleDateTime.dayName}, ${selectedRescheduleDateTime.monthName} ${selectedRescheduleDateTime.dayNumber} at ${time}`;
                selectedTimeDisplay.style.display = 'block';
            }
        }
        
        function submitRescheduleRequest() {
            // Debug: Check all values
            console.log('=== Reschedule Request Debug ===');
            console.log('selectedRescheduleDateTime:', selectedRescheduleDateTime);
            console.log('currentRescheduleLesson:', currentRescheduleLesson);
            
            // Validation
            if (!selectedRescheduleDateTime || !selectedRescheduleDateTime.time || !currentRescheduleLesson) {
                alert('Please select a new date and time for rescheduling');
                return;
            }
            
            const reasonElement = document.getElementById('rescheduleReason');
            console.log('Reason element:', reasonElement);
            console.log('Reason element value:', reasonElement ? reasonElement.value : 'Element not found');
            console.log('Reason element type:', reasonElement ? reasonElement.tagName : 'N/A');
            console.log('Reason element id:', reasonElement ? reasonElement.id : 'N/A');
            
            const reason = reasonElement ? reasonElement.value.trim() : '';
            console.log('Trimmed reason:', reason);
            console.log('Reason length:', reason.length);
            console.log('Reason is empty?', reason === '');
            console.log('Reason is falsy?', !reason);
            
            if (!reason) {
                alert('Please provide a reason for rescheduling');
                return;
            }
            
            if (reason.length < 10) {
                alert('Please provide a more detailed reason (at least 10 characters)');
                return;
            }
            
            try {
                // Create reschedule request
                const rescheduleRequest = {
                    id: `reschedule_${Date.now()}`,
                    lessonId: currentRescheduleLesson.id,
                    studentId: "12345678",
                    tutorId: currentRescheduleLesson.tutorId,
                    tutorName: currentRescheduleLesson.tutorName,
                    currentDateTime: `${currentRescheduleLesson.date}T${currentRescheduleLesson.time}`,
                    requestedDateTime: `${selectedRescheduleDateTime.dateString}T${selectedRescheduleDateTime.time}`,
                    reason: reason,
                    status: 'pending', // pending, approved, rejected
                    createdAt: new Date().toISOString(),
                    studentName: "Nguyen Van A" // Demo student name
                };
                
                // Save to localStorage for both learner and tutor
                saveRescheduleRequest(rescheduleRequest);
                
                // Also save to tutor's pending requests
                saveTutorPendingRequest(rescheduleRequest);
                
                // Show success message with more details
                const successMessage = `
✅ Reschedule Request Sent Successfully!

📅 Current Lesson: ${currentRescheduleLesson.date} at ${currentRescheduleLesson.time}
🔄 Requested Change: ${selectedRescheduleDateTime.dayName}, ${selectedRescheduleDateTime.monthName} ${selectedRescheduleDateTime.dayNumber} at ${selectedRescheduleDateTime.time}
👨‍🏫 Tutor: ${currentRescheduleLesson.tutorName}
📝 Reason: ${reason}

Your request has been sent to the tutor. You will be notified when they respond.
                `;
                
                alert(successMessage);
                
                // Close modal
                closeRescheduleModal();
                
                // Refresh My Schedule to show updated status
                if (typeof renderMyScheduleWeekCalendar === 'function') {
                    renderMyScheduleWeekCalendar();
                }
                if (typeof loadUpcomingLessons === 'function') {
                    loadUpcomingLessons();
                }
                
            } catch (error) {
                console.error('Error submitting reschedule request:', error);
                alert('Error submitting request: ' + error.message);
            }
        }
        
        function saveRescheduleRequest(request) {
            try {
                const existingRequests = JSON.parse(localStorage.getItem('rescheduleRequests') || '[]');
                existingRequests.push(request);
                localStorage.setItem('rescheduleRequests', JSON.stringify(existingRequests));
                console.log('Reschedule request saved:', request);
            } catch (error) {
                console.error('Error saving reschedule request:', error);
            }
        }
        
        function saveTutorPendingRequest(request) {
            try {
                // Save to tutor's pending requests
                const tutorPendingRequests = JSON.parse(localStorage.getItem('tutorPendingRequests') || '[]');
                tutorPendingRequests.push(request);
                localStorage.setItem('tutorPendingRequests', JSON.stringify(tutorPendingRequests));
                console.log('Tutor pending request saved:', request);
            } catch (error) {
                console.error('Error saving tutor pending request:', error);
            }
        }
        
        function testRescheduleValidation() {
            console.log('=== Testing Reschedule Validation ===');
            
            const reasonElement = document.getElementById('rescheduleReason');
            console.log('Reason element found:', !!reasonElement);
            console.log('Reason element:', reasonElement);
            
            if (reasonElement) {
                console.log('Element ID:', reasonElement.id);
                console.log('Element value:', reasonElement.value);
                console.log('Element value length:', reasonElement.value.length);
                console.log('Trimmed value:', reasonElement.value.trim());
                console.log('Trimmed length:', reasonElement.value.trim().length);
                console.log('Is empty after trim:', reasonElement.value.trim() === '');
            }
            
            // Test the actual validation logic
            const reason = reasonElement ? reasonElement.value.trim() : '';
            console.log('Final reason value:', reason);
            console.log('Validation result:', !reason ? 'FAILED - Empty reason' : reason.length < 10 ? 'FAILED - Too short' : 'PASSED');
            
            alert(`Validation Test Results:\n\nElement found: ${!!reasonElement}\nValue: "${reason}"\nLength: ${reason.length}\nResult: ${!reason ? 'FAILED - Empty' : reason.length < 10 ? 'FAILED - Too short' : 'PASSED'}`);
        }
        
        function mySchedulePreviousWeek() {
            myScheduleWeekStart.setDate(myScheduleWeekStart.getDate() - 7);
            renderMyScheduleWeekCalendar();
        }
        
        function myScheduleCurrentWeek() {
            myScheduleWeekStart = new Date();
            myScheduleWeekStart.setDate(myScheduleWeekStart.getDate() - myScheduleWeekStart.getDay() + 1);
            renderMyScheduleWeekCalendar();
        }
        
        function myScheduleNextWeek() {
            myScheduleWeekStart.setDate(myScheduleWeekStart.getDate() + 7);
            renderMyScheduleWeekCalendar();
        }


        

        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Add initial certificate field
            addCertificateField();
            
            // Add event listeners for certificate button
            const addCertificateBtn = document.getElementById('addCertificateBtn');
            if (addCertificateBtn) {
                addCertificateBtn.addEventListener('click', addCertificateField);
            }
            
            // Add event listeners for status tabs
            const statusTabs = document.querySelectorAll('.status-tab');
            statusTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.id.replace('Tab', '');
                    switchStatusTab(tabName);
                });
            });
            
            // Check if tutor application buttons exist (for logging only)
            const saveBtn = document.getElementById('saveTutorApplyBtn');
            const previewBtn = document.getElementById('previewTutorApplyBtn');
            const editBtn = document.getElementById('editTutorApplyBtn');
            const submitBtn = document.getElementById('submitTutorApplyBtn');
            
            console.log('Tutor application buttons check:');
            console.log('Save button found:', !!saveBtn);
            console.log('Preview button found:', !!previewBtn);
            console.log('Edit button found:', !!editBtn);
            console.log('Submit button found:', !!submitBtn);
            console.log('Using onclick attributes instead of addEventListener to avoid duplicates');
            
            // Load interview details when page loads
            loadInterviewDetails();
            
            // Test Find Tutor Modal
            console.log('Page loaded. Test Find Tutor Modal by clicking the menu item or running: showFindTutorModal()');
            
            // Add ESC key listener for modals
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    console.log('ESC key pressed - closing all modals');
                    closeFindTutorModal();
                    closeTutorProfileModal();
                    closeFullScheduleModal();
                    closeMyScheduleModal();
                    closeRescheduleModal();
                    closeProfileModal();
                }
            });
            

        });
    </script>

    <!-- Tutor Profile Modal -->
    <div id="tutorProfileModal" class="modal" style="display: none; position: fixed; z-index: 10002; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeTutorProfileModal()">
        <div class="modal-content" style="width: 95%; max-width: 1400px; max-height: 95vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Profile Header -->
            <div class="profile-header" style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeTutorProfileModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="display: flex; align-items: center; gap: 20px;">
                    <!-- Avatar -->
                    <div id="profileAvatar" style="width: 80px; height: 80px; border-radius: 50%; background: white; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--learner-primary);">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    
                    <!-- Basic Info -->
                    <div style="flex: 1;">
                        <h1 id="profileName" style="margin: 0 0 8px 0; font-size: 2rem; font-weight: 600;">Tutor Name</h1>
                        <div style="display: flex; align-items: center; gap: 16px; font-size: 1rem;">
                            <span id="profileAccent">Accent</span>
                            <span style="display: flex; align-items: center; gap: 4px;">
                                <i class="fas fa-star" style="color: #FFD700;"></i>
                                <span id="profileRating">Rating</span>
                            </span>
                            <span style="display: flex; align-items: center; gap: 4px;">
                                <i class="fas fa-users"></i>
                                <span id="profileLessons">Lessons</span>
                            </span>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div style="display: flex; gap: 12px;">
                        <button style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 8px; padding: 12px 16px; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                            <i class="fas fa-comment"></i> Chat
                        </button>
                        <button style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 8px; padding: 12px 16px; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                            <i class="fas fa-bookmark"></i> Save
                        </button>
                        <button style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 8px; padding: 12px 16px; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                            <i class="fas fa-user-plus"></i> Follow
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Profile Content -->
            <div style="display: flex; height: calc(95vh - 140px);">
                <!-- Left Panel - Tutor Details -->
                <div style="width: 60%; padding: 24px; overflow-y: auto;">
                    <!-- Stats Row -->
                    <div style="display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap;">
                        <div style="background: #f8f9fa; padding: 12px 16px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-chart-bar" style="color: var(--learner-primary);"></i>
                            <span id="profileTeachingLevels">Teaching Levels</span>
                        </div>
                        <div style="background: #f8f9fa; padding: 12px 16px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-certificate" style="color: var(--learner-primary);"></i>
                            <span id="profileTestFamiliarity">Test Familiarity</span>
                        </div>
                        <div style="background: #f8f9fa; padding: 12px 16px; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-briefcase" style="color: var(--learner-primary);"></i>
                            <span id="profileIndustry">Industry Experience</span>
                        </div>
                    </div>
                    
                    <!-- Tabs -->
                    <div style="border-bottom: 2px solid #e0e0e0; margin-bottom: 24px;">
                        <div style="display: flex; gap: 32px;">
                            <button id="tabAbout" onclick="switchProfileTab('about')" style="background: none; border: none; padding: 12px 0; font-size: 1.1rem; font-weight: 500; color: var(--learner-primary); border-bottom: 3px solid var(--learner-primary); cursor: pointer;">About</button>
                            <button id="tabReviews" onclick="switchProfileTab('reviews')" style="background: none; border: none; padding: 12px 0; font-size: 1.1rem; font-weight: 500; color: #666; cursor: pointer;">Reviews</button>
                            <button id="tabSpecialties" onclick="switchProfileTab('specialties')" style="background: none; border: none; padding: 12px 0; font-size: 1.1rem; font-weight: 500; color: #666; cursor: pointer;">Specialties</button>
                            <button id="tabExperience" onclick="switchProfileTab('experience')" style="background: none; border: none; padding: 12px 0; font-size: 1.1rem; font-weight: 500; color: #666; cursor: pointer;">Experience</button>
                        </div>
                    </div>
                    
                    <!-- Tab Content -->
                    <div id="tabContent">
                        <!-- About Tab Content -->
                        <div id="aboutContent">
                            <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Hello!</h3>
                            <p id="profileAbout" style="line-height: 1.6; margin-bottom: 24px; color: #333;">About content will be loaded here...</p>
                            
                            <div style="display: flex; flex-direction: column; gap: 16px;">
                                <div>
                                    <h4 style="color: #333; margin-bottom: 8px;">Student Preferences</h4>
                                    <button id="profilePreferences" style="background: #e3f2fd; color: var(--learner-primary); border: 1px solid var(--learner-primary); border-radius: 6px; padding: 8px 16px; font-size: 0.9rem;">Open to new students</button>
                                </div>
                                <div>
                                    <h4 style="color: #333; margin-bottom: 8px;">Languages</h4>
                                    <div id="profileLanguages" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
                                </div>
                                <div>
                                    <h4 style="color: #333; margin-bottom: 8px;">Industry Familiarity</h4>
                                    <div id="profileIndustryFamiliar" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Reviews Tab Content -->
                        <div id="reviewsContent" style="display: none;">
                            <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Student Reviews</h3>
                            <div id="reviewsList" style="display: flex; flex-direction: column; gap: 16px;"></div>
                        </div>
                        
                        <!-- Specialties Tab Content -->
                        <div id="specialtiesContent" style="display: none;">
                            <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Teaching Specialties</h3>
                            <div id="specialtiesList" style="display: flex; flex-wrap: wrap; gap: 12px;"></div>
                        </div>
                        
                        <!-- Experience Tab Content -->
                        <div id="experienceContent" style="display: none;">
                            <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Professional Experience</h3>
                            <p id="profileExperience" style="line-height: 1.6; color: #333;">Experience content will be loaded here...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Right Panel - Video & Booking -->
                <div style="width: 40%; background: #f8f9fa; padding: 24px; border-left: 1px solid #e0e0e0; overflow-y: auto;">
                    <!-- Video Section -->
                    <div style="margin-bottom: 24px;">
                        <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Introduction Video</h3>
                        <div style="background: #000; border-radius: 8px; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; position: relative;">
                            <video id="profileVideo" controls style="width: 100%; height: 100%; border-radius: 8px;">
                                <source src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div id="videoPlaceholder" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; text-align: center;">
                                <i class="fas fa-play-circle" style="font-size: 3rem; margin-bottom: 8px;"></i>
                                <p>Video Introduction</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Booking Section -->
                    <div>
                        <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Book a Lesson</h3>
                        <div style="background: white; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <div id="bookingAvatar" style="width: 40px; height: 40px; border-radius: 50%; background: var(--learner-primary); display: flex; align-items: center; justify-content: center; color: white; font-size: 1rem;">
                                    <i class="fas fa-user-graduate"></i>
                                </div>
                                <span id="bookingName" style="font-weight: 500;">Tutor Name</span>
                            </div>
                            
                            <!-- Calendar -->
                            <div id="bookingCalendar" style="margin-bottom: 16px;">
                                <!-- Calendar content will be loaded here -->
                            </div>
                            
                            <div style="color: #28a745; font-size: 0.9rem; margin-bottom: 16px;">
                                <i class="fas fa-circle" style="font-size: 0.5rem; margin-right: 8px;"></i> Active today
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div style="display: flex; gap: 12px;">
                            <button style="background: var(--learner-primary); color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; font-weight: 500; cursor: pointer; flex: 1; transition: background 0.2s;" onmouseover="this.style.background='#1565c0'" onmouseout="this.style.background='var(--learner-primary)'">
                                <i class="fas fa-comment"></i> Message
                            </button>
                            <button onclick="showFullSchedule()" style="background: #28a745; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; font-weight: 500; cursor: pointer; flex: 1; transition: background 0.2s;" onmouseover="this.style.background='#218838'" onmouseout="this.style.background='#28a745'">
                                <i class="fas fa-calendar"></i> See Full Schedule
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Full Schedule Modal -->
    <div id="fullScheduleModal" class="modal" style="display: none; position: fixed; z-index: 10003; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeFullScheduleModal()">
        <div class="modal-content" style="width: 95%; max-width: 1200px; max-height: 90vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Schedule Header -->
            <div class="schedule-header" style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeFullScheduleModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="display: flex; align-items: center; gap: 16px;">
                    <i class="fas fa-calendar-alt" style="font-size: 1.5rem;"></i>
                    <div>
                        <h2 id="scheduleTutorName" style="margin: 0; font-size: 1.6rem;">Tutor Schedule</h2>
                        <div id="scheduleWeekRange" style="font-size: 0.9rem; opacity: 0.9;">Week of January 15-21, 2024</div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; margin-top: 16px;">
                    <button onclick="previousWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        <i class="fas fa-chevron-left"></i> Previous Week
                    </button>
                    <button onclick="currentWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        Current Week
                    </button>
                    <button onclick="nextWeek()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 16px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        Next Week <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Schedule Content -->
            <div style="padding: 24px; overflow-y: auto; max-height: calc(90vh - 140px);">
                <!-- Week Calendar -->
                <div id="weekCalendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 12px; margin-bottom: 24px;">
                    <!-- Calendar days will be generated here -->
                </div>
                
                <!-- Booking Section -->
                <div id="bookingSection" style="background: #f8f9fa; border-radius: 8px; padding: 20px; display: none;">
                    <h3 style="color: var(--learner-primary); margin-bottom: 16px;">Book This Session</h3>
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                        <div style="background: var(--learner-primary); color: white; padding: 12px; border-radius: 8px; font-weight: 500;">
                            <div id="selectedDate">Selected Date</div>
                            <div id="selectedTime">Selected Time</div>
                        </div>
                        <div>
                            <div style="font-weight: 500; color: #333;">Duration: 60 minutes</div>
                            <div style="color: #666; font-size: 0.9rem;">Standard lesson duration</div>
                        </div>
                    </div>
                    <button onclick="bookSelectedSession()" style="background: #28a745; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#218838'" onmouseout="this.style.background='#28a745'">
                        <i class="fas fa-calendar-plus"></i> Book This Session
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Modal -->
    <div id="rescheduleModal" class="modal" style="display: none; position: fixed; z-index: 10005; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeRescheduleModal()">
        <div class="modal-content" style="width: 90%; max-width: 600px; max-height: 90vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Reschedule Header -->
            <div class="reschedule-header" style="background: linear-gradient(135deg, #ff9800, #f57c00); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeRescheduleModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="display: flex; align-items: center; gap: 16px;">
                    <i class="fas fa-clock" style="font-size: 1.5rem;"></i>
                    <div>
                        <h2 id="rescheduleTitle" style="margin: 0; font-size: 1.6rem;">Reschedule Lesson</h2>
                        <div id="rescheduleCurrentInfo" style="font-size: 0.9rem; opacity: 0.9;">Current: Loading...</div>
                    </div>
                </div>
            </div>
            
            <!-- Reschedule Content -->
            <div style="padding: 24px;">
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Select New Time</h3>
                    <div id="rescheduleCalendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-bottom: 16px;">
                        <!-- Calendar will be generated here -->
                    </div>
                    <div id="rescheduleTimeSlots" style="display: flex; flex-wrap: wrap; gap: 8px;">
                        <!-- Time slots will be generated here -->
                    </div>
                    
                    <!-- Selected Time Display -->
                    <div id="selectedTimeDisplay" style="display: none; margin-top: 16px; padding: 12px; background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; color: #2e7d32; font-weight: 600; text-align: center;">
                        <!-- Selected time will be displayed here -->
                    </div>
                </div>
                
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Reason for Reschedule</h3>
                    <textarea id="rescheduleReason" placeholder="Please explain why you need to reschedule this lesson..." style="width: 100%; min-height: 100px; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                </div>
                
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button onclick="testRescheduleValidation()" style="background: #17a2b8; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#138496'" onmouseout="this.style.background='#17a2b8'">
                        <i class="fas fa-bug"></i> Test Validation
                    </button>
                    <button onclick="closeRescheduleModal()" style="background: #6c757d; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#5a6268'" onmouseout="this.style.background='#6c757d'">
                        Cancel
                    </button>
                    <button onclick="submitRescheduleRequest()" style="background: #ff9800; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; font-weight: 500; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#f57c00'" onmouseout="this.style.background='#ff9800'">
                        <i class="fas fa-paper-plane"></i> Send Request to Tutor
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Find Tutor Modal -->
    <div id="findTutorModal" class="modal" style="display: none; position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;" onclick="closeFindTutorModal()">
        <div class="modal-content" style="width: 90%; max-width: 1200px; max-height: 90vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Enhanced Header -->
            <div class="modal-header" style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0;">
                <div style="display: flex; align-items: center; gap: 16px;">
                    <i class="fas fa-search" style="font-size: 1.5rem;"></i>
                    <div>
                        <h2 style="margin: 0; font-size: 1.8rem;">Find a Tutor</h2>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Dashboard > Find Tutor</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <button onclick="toggleFullscreen()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 6px; padding: 8px 12px; cursor: pointer; font-size: 0.9rem;">
                        <i class="fas fa-expand"></i> Fullscreen
                    </button>
                    <button onclick="closeFindTutorModal()" style="background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="modal-body" style="display: flex; height: calc(95vh - 100px);">
                <!-- Left Sidebar - Advanced Filters -->
                <div style="width: 280px; background: #f8f9fa; padding: 20px; border-right: 1px solid #e0e0e0; overflow-y: auto;">
                    <h3 style="color: var(--learner-primary); margin: 0 0 20px 0; font-size: 1.3rem;">
                        <i class="fas fa-filter"></i> Filters
                    </h3>
                    
                    <!-- Search Bar -->
                    <div style="margin-bottom: 24px;">
                        <label style="font-weight: 500; font-size: 1rem; color: #333; display: block; margin-bottom: 8px;">
                            <i class="fas fa-search"></i> Search Tutors
                        </label>
                        <input type="text" id="tutorNameFilter" onkeyup="debounceFilter()" placeholder="Search by name..." 
                               style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; background: white;">
                    </div>
                    
                    <!-- Subject Filter -->
                    <div style="margin-bottom: 24px;">
                        <label style="font-weight: 500; font-size: 1rem; color: #333; display: block; margin-bottom: 8px;">
                            <i class="fas fa-book"></i> Subject
                        </label>
                        <select id="subjectFilter" onchange="filterTutors()" 
                                style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; background: white;">
                            <option value="">All Subjects</option>
                            <option value="mathematics">Mathematics</option>
                            <option value="physics">Physics</option>
                            <option value="chemistry">Chemistry</option>
                            <option value="english">English</option>
                            <option value="cs">Computer Science</option>
                            <option value="biology">Biology</option>
                            <option value="economics">Economics</option>
                        </select>
                    </div>
                    
                    <!-- Rating Filter -->
                    <div style="margin-bottom: 24px;">
                        <label style="font-weight: 500; font-size: 1rem; color: #333; display: block; margin-bottom: 8px;">
                            <i class="fas fa-star"></i> Minimum Rating
                        </label>
                        <select id="ratingFilter" onchange="filterTutors()" 
                                style="width: 100%; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; background: white;">
                            <option value="0">Any Rating</option>
                            <option value="4.0">4.0+ Stars</option>
                            <option value="4.5">4.5+ Stars</option>
                            <option value="4.8">4.8+ Stars</option>
                        </select>
                    </div>
                    
                    <!-- Experience Level Filter -->
                    <div style="margin-bottom: 24px;">
                        <label style="font-weight: 500; font-size: 1rem; color: #333; display: block; margin-bottom: 8px;">
                            <i class="fas fa-user-graduate"></i> Experience Level
                        </label>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="expertTutor" onchange="filterTutors()" style="transform: scale(1.2);">
                                <span style="font-size: 0.9rem;">Expert Tutor</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="superTutor" onchange="filterTutors()" style="transform: scale(1.2);">
                                <span style="font-size: 0.9rem;">Super Tutor</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="topRated" onchange="filterTutors()" style="transform: scale(1.2);">
                                <span style="font-size: 0.9rem;">Top Rated</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Active Filters -->
                    <div id="activeFilters" style="margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; color: #333; margin: 0 0 12px 0;">Active Filters</h4>
                        <div id="filterTags" style="display: flex; flex-wrap: wrap; gap: 6px;">
                            <!-- Filter tags will be added here -->
                        </div>
                    </div>
                    
                    <!-- Reset Button -->
                    <button onclick="resetFilters()" 
                            style="width: 100%; background: #6c757d; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 1rem; cursor: pointer; transition: background 0.3s;">
                        <i class="fas fa-refresh"></i> Reset All Filters
                    </button>
                </div>
                
                <!-- Main Content Area -->
                <div style="flex: 1; padding: 20px; overflow-y: auto;">
                    <!-- Toolbar -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding: 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <div style="display: flex; align-items: center; gap: 16px;">
                            <div style="color: #666; font-size: 1rem;">
                                <i class="fas fa-users"></i> <span id="tutorCount">15</span> tutors found
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 0.9rem; color: #666;">Sort by:</span>
                                <select id="sortFilter" onchange="filterTutors()" 
                                        style="padding: 6px 12px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 0.9rem;">
                                    <option value="rating">Rating (High to Low)</option>
                                    <option value="name">Name (A-Z)</option>
                                    <option value="reviews">Most Reviews</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button onclick="toggleViewMode()" id="viewToggle" 
                                    style="background: var(--learner-primary); color: white; border: none; border-radius: 6px; padding: 8px 12px; cursor: pointer; font-size: 0.9rem;">
                                <i class="fas fa-th"></i> Grid
                            </button>
                        </div>
                    </div>
                    
                    <!-- Tutors Grid -->
                    <div id="tutorsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px;">
                        <!-- Tutor cards will be loaded here -->
                    </div>
                    
                    <!-- Empty State -->
                    <div id="emptyState" style="display: none; text-align: center; padding: 60px 20px;">
                        <i class="fas fa-search" style="font-size: 4rem; color: #ccc; margin-bottom: 20px;"></i>
                        <h3 style="color: #666; margin-bottom: 12px;">No tutors found</h3>
                        <p style="color: #999; margin-bottom: 24px;">Try adjusting your filters or search criteria</p>
                        <button onclick="resetFilters()" style="background: var(--learner-primary); color: white; border: none; border-radius: 8px; padding: 12px 24px; cursor: pointer;">
                            <i class="fas fa-refresh"></i> Reset Filters
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Rating Modal -->
    <div id="ratingModal" style="display: none; position: fixed; z-index: 10010; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center;">
        <div style="width: 90%; max-width: 600px; max-height: 90vh; overflow: hidden; background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative;" onclick="event.stopPropagation();">
            <!-- Rating Header -->
            <div style="background: linear-gradient(135deg, var(--learner-primary), #1976d2); color: white; padding: 20px 24px; border-radius: 12px 12px 0 0; position: relative;">
                <button onclick="closeRatingModal()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fas fa-times"></i>
                </button>
                <div style="display: flex; align-items: center; gap: 16px;">
                    <i class="fas fa-star" style="font-size: 1.5rem;"></i>
                    <div>
                        <h2 style="margin: 0; font-size: 1.6rem;">Rate Your Tutor</h2>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Share your experience</div>
                    </div>
                </div>
            </div>
            
            <!-- Rating Content -->
            <div style="padding: 24px; overflow-y: auto; max-height: calc(90vh - 140px);">
                <!-- Teaching Quality Rating -->
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Teaching Quality</h3>
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <span class="rating-star" data-value="1">★</span>
                        <span class="rating-star" data-value="2">★</span>
                        <span class="rating-star" data-value="3">★</span>
                        <span class="rating-star" data-value="4">★</span>
                        <span class="rating-star" data-value="5">★</span>
                    </div>
                    <div id="teachingRating" style="color: #666; font-size: 0.9rem;">Click to rate</div>
                </div>
                
                <!-- Communication Rating -->
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Communication Skills</h3>
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <span class="rating-star" data-value="1">★</span>
                        <span class="rating-star" data-value="2">★</span>
                        <span class="rating-star" data-value="3">★</span>
                        <span class="rating-star" data-value="4">★</span>
                        <span class="rating-star" data-value="5">★</span>
                    </div>
                    <div id="communicationRating" style="color: #666; font-size: 0.9rem;">Click to rate</div>
                </div>
                
                <!-- Helpfulness Rating -->
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Helpfulness & Support</h3>
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <span class="rating-star" data-value="1">★</span>
                        <span class="rating-star" data-value="2">★</span>
                        <span class="rating-star" data-value="3">★</span>
                        <span class="rating-star" data-value="4">★</span>
                        <span class="rating-star" data-value="5">★</span>
                    </div>
                    <div id="helpfulnessRating" style="color: #666; font-size: 0.9rem;">Click to rate</div>
                </div>
                
                <!-- Comments -->
                <div style="margin-bottom: 24px;">
                    <h3 style="color: #333; margin-bottom: 16px;">Additional Comments</h3>
                    <textarea id="ratingComment" rows="4" placeholder="Share your thoughts about the lesson..." style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; resize: vertical;"></textarea>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button onclick="closeRatingModal()" style="background: #6c757d; color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#5a6268'" onmouseout="this.style.background='#6c757d'">
                        Cancel
                    </button>
                    <button onclick="submitLearnerRating()" style="background: var(--learner-primary); color: white; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#1976d2'" onmouseout="this.style.background='var(--learner-primary)'">
                        <i class="fas fa-star"></i> Submit Rating
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ... existing code ...
        
        // Rating Functions
        let ratingData = {
            teaching: 0,
            communication: 0,
            helpfulness: 0
        };
        
        function showRatingModal() {
            console.log('Opening rating modal...');
            document.getElementById('ratingModal').style.display = 'flex';
            resetRatingForm();
        }
        
        function closeRatingModal() {
            console.log('Closing rating modal...');
            document.getElementById('ratingModal').style.display = 'none';
            resetRatingForm();
        }
        
        function resetRatingForm() {
            ratingData = {
                teaching: 0,
                communication: 0,
                helpfulness: 0
            };
            
            // Reset all stars
            document.querySelectorAll('.rating-star').forEach(star => {
                star.style.color = '#e0e0e0';
            });
            
            // Reset rating text
            document.getElementById('teachingRating').textContent = 'Click to rate';
            document.getElementById('communicationRating').textContent = 'Click to rate';
            document.getElementById('helpfulnessRating').textContent = 'Click to rate';
            
            // Reset comment
            document.getElementById('ratingComment').value = '';
        }
        
        // Star rating logic
        document.addEventListener('DOMContentLoaded', function() {
            // Add click handlers for rating stars
            document.querySelectorAll('.rating-star').forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    const category = this.closest('div').nextElementSibling.id.replace('Rating', '');
                    
                    // Update rating data
                    ratingData[category] = value;
                    
                    // Update star colors
                    const stars = this.parentElement.querySelectorAll('.rating-star');
                    stars.forEach((s, index) => {
                        if (index < value) {
                            s.style.color = '#ffc107';
                        } else {
                            s.style.color = '#e0e0e0';
                        }
                    });
                    
                    // Update rating text
                    const ratingText = document.getElementById(category + 'Rating');
                    const ratingLabels = {
                        teaching: ['Poor', 'Fair', 'Good', 'Very Good', 'Excellent'],
                        communication: ['Unclear', 'Somewhat Clear', 'Clear', 'Very Clear', 'Excellent'],
                        helpfulness: ['Unhelpful', 'Somewhat Helpful', 'Helpful', 'Very Helpful', 'Excellent']
                    };
                    
                    ratingText.textContent = ratingLabels[category][value - 1];
                });
            });
        });
        
        function submitLearnerRating() {
            console.log('=== SUBMITTING LEARNER RATING ===');
            console.log('Current page:', window.location.href);
            
            // Validate ratings
            if (ratingData.teaching === 0 || ratingData.communication === 0 || ratingData.helpfulness === 0) {
                alert('Please rate all categories before submitting.');
                return;
            }
            
            // Calculate average rating
            const averageRating = (ratingData.teaching + ratingData.communication + ratingData.helpfulness) / 3;
            
            // Save rating data (in real app, this would be sent to server)
            const ratingSubmission = {
                timestamp: new Date().toISOString(),
                studentId: 'student_001',
                tutorId: 'tutor_001',
                ratings: ratingData,
                averageRating: averageRating,
                comment: document.getElementById('ratingComment').value,
                lessonId: 'lesson_001'
            };
            
            // Store in localStorage for demo
            const ratings = JSON.parse(localStorage.getItem('learnerRatings') || '[]');
            ratings.push(ratingSubmission);
            localStorage.setItem('learnerRatings', JSON.stringify(ratings));
            
            console.log('Rating submitted:', ratingSubmission);
            
            // Show success message
            alert('Rating submitted successfully! Redirecting to learner dashboard...');
            
            // Force redirect to learner page (bypass role detection)
            console.log('🎯 FORCE REDIRECTING TO LEARNER PAGE');
            localStorage.setItem('userRole', 'student');
            window.location.href = 'learner-new.html';
        }
        
        function redirectBasedOnRole() {
            // Detect user role (you can customize this based on your authentication system)
            const userRole = detectUserRole();
            console.log('Redirecting based on role:', userRole);
            
            // Since this is learner-new.html, force redirect to learner page
            console.log('🎯 Force redirecting to learner page (since we are on learner page)');
            localStorage.setItem('userRole', 'student'); // Ensure role is set correctly
            window.location.href = 'learner-new.html';
        }
        
        function detectUserRole() {
            console.log('Detecting user role...');
            
            // Method 1: Check URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const roleFromUrl = urlParams.get('role');
            if (roleFromUrl) {
                console.log('Role from URL parameter:', roleFromUrl);
                return roleFromUrl;
            }
            
            // Method 2: Check localStorage
            const storedRole = localStorage.getItem('userRole');
            if (storedRole) {
                console.log('Role from localStorage:', storedRole);
                return storedRole;
            }
            
            // Method 3: Check if we're on tutor page
            if (window.location.pathname.includes('tutor-new.html')) {
                console.log('Detected tutor page, setting role to tutor');
                localStorage.setItem('userRole', 'tutor'); // Set it for future use
                return 'tutor';
            }
            
            // Method 4: Check if we're on learner page (most reliable)
            if (window.location.pathname.includes('learner-new.html')) {
                console.log('Detected learner page, setting role to student');
                localStorage.setItem('userRole', 'student'); // Set it for future use
                return 'student';
            }
            
            // Method 5: Default fallback
            console.log('No role detected, defaulting to student');
            return 'student';
        }
        
        // Function to set user role for testing
        function setUserRole(role) {
            localStorage.setItem('userRole', role);
            console.log('User role set to:', role);
        }
        
        // Function to debug current role
        function debugCurrentRole() {
            console.log('=== ROLE DEBUG ===');
            console.log('Current URL:', window.location.href);
            console.log('URL pathname:', window.location.pathname);
            console.log('localStorage userRole:', localStorage.getItem('userRole'));
            console.log('Detected role:', detectUserRole());
            console.log('==================');
        }
        
        // Function to test rating flow
        function testRatingFlow() {
            console.log('🧪 Testing rating flow...');
            console.log('Current role:', detectUserRole());
            console.log('Will redirect to:', detectUserRole() === 'student' ? 'learner-new.html' : 'tutor-new.html');
            
            // Simulate rating submission
            alert('Testing rating flow - will redirect based on current role');
            redirectBasedOnRole();
        }
        
        // Add rating button to lesson actions (if needed)
        function addRatingButton() {
            // This could be called when a lesson ends
            console.log('Lesson ended, showing rating option...');
            showRatingModal();
        }
        
        // Function to start lesson (for learner)
        function startLesson(lessonId) {
            // Confirm before starting lesson
            if (confirm('Are you sure you want to start this lesson?')) {
                console.log('Starting lesson:', lessonId);
                // Pass userType=student to lesson.html
                window.location.href = 'lesson.html?userType=student';
            }
        }
        
        // ... existing code ...
    </script>
</body>
</html> 
